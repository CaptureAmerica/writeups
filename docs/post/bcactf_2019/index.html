<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>BCACTF Writeup - CTF Writeups</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="きゃぷあめ" /><meta name="description" content="URL: https://www.bcactf.com/ 前回のHSCTFに続き、これも学生さん用のCTFでした。 だいたい解けたけど、解けなかったやつもありました。 あまりに簡単だったやつは、省略" /><meta name="keywords" content="CTF, Writeup, captureamerica, picoCTF" />



<meta name="google-site-verification" content="PqctLWZQttGzxXVupWuIt2HWuBI8cvN1z07ETpxA2dw" />


<meta name="generator" content="Hugo 0.60.1 with theme even" />


<link rel="canonical" href="https://captureamerica.github.io/writeups/post/bcactf_2019/" />
<link rel="apple-touch-icon" sizes="180x180" href="https://captureamerica.github.io/writeups/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://captureamerica.github.io/writeups/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://captureamerica.github.io/writeups/favicon-16x16.png">
<link rel="manifest" href="https://captureamerica.github.io/writeups/manifest.json">
<link rel="mask-icon" href="https://captureamerica.github.io/writeups/safari-pinned-tab.svg" color="#5bbad5">


<link href="https://captureamerica.github.io/writeups/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="BCACTF Writeup" />
<meta property="og:description" content="URL: https://www.bcactf.com/ 前回のHSCTFに続き、これも学生さん用のCTFでした。 だいたい解けたけど、解けなかったやつもありました。 あまりに簡単だったやつは、省略" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://captureamerica.github.io/writeups/post/bcactf_2019/" />
<meta property="article:published_time" content="2019-06-16T13:00:00+09:00" />
<meta property="article:modified_time" content="2019-09-23T09:00:00+09:00" />
<meta itemprop="name" content="BCACTF Writeup">
<meta itemprop="description" content="URL: https://www.bcactf.com/ 前回のHSCTFに続き、これも学生さん用のCTFでした。 だいたい解けたけど、解けなかったやつもありました。 あまりに簡単だったやつは、省略">
<meta itemprop="datePublished" content="2019-06-16T13:00:00&#43;09:00" />
<meta itemprop="dateModified" content="2019-09-23T09:00:00&#43;09:00" />
<meta itemprop="wordCount" content="6550">



<meta itemprop="keywords" content="CTF,Reviewed," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="BCACTF Writeup"/>
<meta name="twitter:description" content="URL: https://www.bcactf.com/ 前回のHSCTFに続き、これも学生さん用のCTFでした。 だいたい解けたけど、解けなかったやつもありました。 あまりに簡単だったやつは、省略"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="https://captureamerica.github.io/writeups/" class="logo">CTF Writeups</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="https://captureamerica.github.io/writeups/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="https://captureamerica.github.io/writeups/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="https://captureamerica.github.io/writeups/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="https://captureamerica.github.io/writeups/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="https://captureamerica.github.io/writeups/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="https://captureamerica.github.io/writeups/" class="logo">CTF Writeups</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/about/">About</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">BCACTF Writeup</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-06-16 </span>
        <div class="post-category">
            <a href="https://captureamerica.github.io/writeups/categories/ctf/"> CTF </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#challenge">Challenge</a></li>
    <li><a href="#solution">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge1">Challenge</a></li>
    <li><a href="#solution1">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge2">Challenge</a></li>
    <li><a href="#solution2">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge3">Challenge</a></li>
    <li><a href="#not-solved">Not solved</a></li>
  </ul>

  <ul>
    <li><a href="#challenge4">Challenge</a></li>
    <li><a href="#solution3">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge5">Challenge</a></li>
    <li><a href="#solution4">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge6">Challenge</a></li>
    <li><a href="#solution5">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge7">Challenge</a></li>
    <li><a href="#solution6">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge8">Challenge</a></li>
    <li><a href="#solution7">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge9">Challenge</a></li>
    <li><a href="#solution8">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge10">Challenge</a></li>
    <li><a href="#solution9">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge11">Challenge</a></li>
    <li><a href="#solution10">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge12">Challenge</a></li>
    <li><a href="#solution11">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge13">Challenge</a></li>
    <li><a href="#solution12">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge14">Challenge</a></li>
    <li><a href="#solution13">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge15">Challenge</a></li>
    <li><a href="#solution14">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge16">Challenge</a></li>
    <li><a href="#solution15">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge17">Challenge</a></li>
    <li><a href="#solution16">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge18">Challenge</a></li>
    <li><a href="#solution17">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge19">Challenge</a></li>
    <li><a href="#solution18">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge20">Challenge</a></li>
    <li><a href="#solution19">Solution</a></li>
  </ul>

  <ul>
    <li><a href="#challenge21">Challenge</a></li>
    <li><a href="#solution20">Solution</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>URL: <a href="https://www.bcactf.com/"><a href="https://www.bcactf.com/">https://www.bcactf.com/</a></a>
<!-- raw HTML omitted --><!-- raw HTML omitted -->
前回のHSCTFに続き、これも学生さん用のCTFでした。
<!-- raw HTML omitted --><!-- raw HTML omitted -->
だいたい解けたけど、解けなかったやつもありました。
<!-- raw HTML omitted --><!-- raw HTML omitted -->
あまりに簡単だったやつは、省略してます。<!-- raw HTML omitted -->
<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="binaryexploitation-executable-150">Binary-exploitation: executable (150)</h1>
<hr>
<h2 id="challenge">Challenge</h2>
<blockquote>
<p>It's in there somewhere. Good luck!</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>executable-mac</li>
<li>executable-ubuntu</li>
</ul>
<h2 id="solution">Solution</h2>
<p>Ghidraでデコンパイルしてコードを確認してみます。以下、抜粋です。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C" data-lang="C">  <span class="n">local_18</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)</span><span class="n">___stack_chk_guard</span><span class="p">;</span>
  <span class="n">_puts</span><span class="p">(</span><span class="sa"></span><span class="s">&#34;</span><span class="s">Welcome to the lottery!</span><span class="s">&#34;</span><span class="p">)</span><span class="p">;</span>
  <span class="n">_puts</span><span class="p">(</span><span class="sa"></span><span class="s">&#34;</span><span class="s">So now we</span><span class="se">\&#39;</span><span class="s">re going to pick a ginormous number!</span><span class="s">&#34;</span><span class="p">)</span><span class="p">;</span>
  <span class="n">_puts</span><span class="p">(</span><span class="sa"></span><span class="s">&#34;</span><span class="s">If it</span><span class="se">\&#39;</span><span class="s">s 1, you win!</span><span class="s">&#34;</span><span class="p">)</span><span class="p">;</span>
  <span class="n">uVar1</span> <span class="o">=</span> <span class="n">_rand</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
  <span class="n">_printf</span><span class="p">(</span><span class="sa"></span><span class="s">&#34;</span><span class="s">Your number is %d!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">uVar1</span><span class="p">)</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">uVar1</span> <span class="o">=</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">_puts</span><span class="p">(</span><span class="sa"></span><span class="s">&#34;</span><span class="s">Congratulations, you</span><span class="se">\&#39;</span><span class="s">re our lucky winner!</span><span class="s">&#34;</span><span class="p">)</span><span class="p">;</span>
    <span class="n">auVar2</span> <span class="o">=</span> <span class="n">pinsrb</span><span class="p">(</span><span class="n">ZEXT416</span><span class="p">(</span><span class="mh">0x3e</span><span class="p">)</span><span class="p">,</span><span class="mh">0xe4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="p">;</span>
    <span class="n">auVar7</span> <span class="o">=</span> <span class="n">pinsrb</span><span class="p">(</span><span class="n">auVar2</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="p">;</span>
    <span class="o">:</span>
</code></pre></td></tr></table>
</div>
</div><p>if()文判定を一個回避するだけで行けそうです。</p>
<p>アプローチとしては、以下が考えられます。</p>
<ol>
<li>rand()の結果が入っているuVar1を1で上書きする</li>
<li>ZFをいじって逆に飛ばす</li>
</ol>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>出力結果はBrainF*ckで、以下で実行しました。<!-- raw HTML omitted -->
<a href="https://copy.sh/brainfuck/"><a href="https://copy.sh/brainfuck/">https://copy.sh/brainfuck/</a></a></p>
<p><code>bcactf{3x3cut4bl3s_r_fun_124jher089245}</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="binaryexploitation-executable2-250">Binary-exploitation: executable-2 (250)</h1>
<hr>
<h2 id="challenge1">Challenge</h2>
<blockquote>
<p>It's in here somewhere. Good luck&hellip; again.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
(Now you actually have to try.)</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>executable-ubuntu</li>
</ul>
<h2 id="solution1">Solution</h2>
<p>問題文の、&quot;(Now you actually have to try.)&rdquo; の意味がよくわかりませんでした。わたしのやり方は、想定解じゃないのかも知れません。トライしてないし。。^^;</p>
<p>Ghidraでデコンパイルしてコードを見たところ、rand()をコールしている部分が増えていましたが、前の問題と大して違いはなかったです。</p>
<p>今度は、ZFをいじってやりました。0x206 -&gt; 0x246</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>同様に出力結果はBrainF*ckで、以下で実行しました。<!-- raw HTML omitted -->
<a href="https://copy.sh/brainfuck/"><a href="https://copy.sh/brainfuck/">https://copy.sh/brainfuck/</a></a></p>
<p>rsqsjv{Arent_executables_fun?_I_think_so_sdkfjhqiweuryiquwerajzncxbvaihqiwueyr}</p>
<p>何パターンか試して、結局、全体をRot10したのがフラグでした。<!-- raw HTML omitted -->
<code>bcactf{Kboxd_ohomedklvoc_pex?_S_drsxu_cy_cnuptrasgoebisaegobktjxmhlfksrasgeoib}</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="crypto-threestepprogram-125">Crypto: three-step-program (125)</h1>
<hr>
<h2 id="challenge2">Challenge</h2>
<blockquote>
<p>We found this strange file with a bunch of stuff in it&hellip; Can you help us decode it?
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint: Looks like you need to do different things to each section&hellip;</p>
</blockquote>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --></p>
<h2 id="solution2">Solution</h2>
<p>1行目をBase64 decodeすると、<code>32 -  |3 Times A Charm| - 32~</code> が取れます。
<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->
これをヒントに、2つ目はBase32 decode x 3です。以下を使わせてもらいました。<!-- raw HTML omitted -->
<a href="https://emn178.github.io/online-tools/base32_decode.html"><a href="https://emn178.github.io/online-tools/base32_decode.html">https://emn178.github.io/online-tools/base32_decode.html</a></a></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted -->
最後の行はフランス語っぽくて、「French crypt the best」ということらしいです。Vigenere cipherですね。</p>
<p>Keyを&quot;SALT&quot;にして、Vigenere cipherをデコードすると、フラグが取れます。<!-- raw HTML omitted -->
<a href="https://cryptii.com/pipes/vigenere-cipher"><a href="https://cryptii.com/pipes/vigenere-cipher">https://cryptii.com/pipes/vigenere-cipher</a></a><!-- raw HTML omitted -->
&ldquo;that was simple enough. so i heard you came for a flag? since you have made it this far, i’ll go easy on you and hand it over. <code>bcactf{ju57_y0u_w4i7_znjhbmnhaxm}</code> but, be warned, next time it won’t be so simple&rdquo;</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="crypto-tupperware-175-------------gave-up">Crypto: tupperware (175)            &lt;=== gave up</h1>
<hr>
<h2 id="challenge3">Challenge</h2>
<blockquote>
<p>Took my lunch to school in a Tupperware (now with patented TupperSRF™ plastic!) and part of it got stained with a flag. k tells you where.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
NOTE: number names come from the Googology wiki, some numbef names may be inconsistent.</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>k （以下は中身の抜粋です。）
<!-- raw HTML omitted -->
Four octogintacentillion, eight hundred and fifty-eight novemseptuagintacentillion, four hundred and eighty-seven octoseptuagintacentillion, &hellip;(snip)&hellip;, seven hundred and eighty-five quadrillion, four hundred and thirty-three trillion, one hundred and five billion, ninety-one million, five hundred and twenty-six thousand, six hundred and thirty-nine.</li>
</ul>
<h2 id="not-solved">Not solved</h2>
<p>以下のような感じでPythonでひらすらreplaceを行って、全部数字にするところまではやりました。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">octogintacentillion</span><span class="s2">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s2">&#34;</span><span class="s2">)*10^543</span><span class="s2">&#34;</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">novemseptuagintacentillion</span><span class="s2">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s2">&#34;</span><span class="s2">)*10^540</span><span class="s2">&#34;</span><span class="p">)</span>
<span class="p">:</span>
</code></pre></td></tr></table>
</div>
</div><p>スペリングが異なる単語が結構あるし、かなり面倒だったけど、これだけできればクリアだろうと思って頑張りました。</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>以下で、上記の式は計算できました。<!-- raw HTML omitted -->
<a href="https://defuse.ca/big-number-calculator.htm"><a href="https://defuse.ca/big-number-calculator.htm">https://defuse.ca/big-number-calculator.htm</a></a>
<!-- raw HTML omitted --></p>
<p>4858487703000217654168507377105634002647731128499307244851441090357865744443419793531999883261579086703285988550325970512343063312965327580978241840458705778582504607655879151828149694589867198840959598497597989866084694560490675801786347730851438931275598708000190409481880911319491978644808036817873514056590135331578105862821454454617375919870245363440066372700053263362863694129133765441926533609503994018565319382913454161429058505655350780911229203432392967236137647780308966936691439636980058266693498568235464310907628785433105091526639</p>
<p><!-- raw HTML omitted -->
で？？</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="crypto-runescape">Crypto: runescape</h1>
<hr>
<h2 id="challenge4">Challenge</h2>
<blockquote>
<p>ᚣᚦᚧᚦᚭᚠ{ᚠᚯᚲᚴᚪᚲᚫᚦᚹᚧᚫᚧᚵᚹᚨᚩᚨᚩᚨᚮᚲᚯᚹᚥᚯᚲᚧᚭᚷᚶᚲᚫᚨᚸᚵᚮᚩᚫᚥᚧᚫᚫᚸᚹᚩᚫᚥᚢᚸᚫᚸᚧᚵᚤᚶᚧᚣᚲᚭᚩᚦᚨᚪᚣᚨᚭᚩᚭᚪᚭᚩᚸᚫᚦᚩᚤᚶᚲᚯᚨ_ᚧᚣᚦᚬᚲᚠᚥᚶᚩᚱᚳᚵᚢᚫᚸᚤᚴᚯᚨᚭᚪᚮᚷᚡᚹᚰ}</p>
</blockquote>
<h2 id="solution3">Solution</h2>
<p>ルーン文字です。<!-- raw HTML omitted --></p>
<p>オンラインでさくっと変換できるのかと思ったら、アスキー文字と1対1で対応しているわけではなくて、単一換字式暗号として解くやつでした。</p>
<p>最初の6文字は、bcactfなのがわかっているので、まずわかっているところから変換します。</p>
<p>すると、アンダースコア('_')より後ろの26文字がアルファベット順に並んでいるのが予想できます。</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>これで、全てのアルファベットの変換ができるので、フラグがわかります。
<code>bcactf{frequencyanalysisisverygreatwhensolvingannoyingmonoalphabeticsubstitutionciphers_abcdefghijklmnopqrstuvwxyz}</code></p>
<p>ちなみに、読みやすくスペースを入れると、<!-- raw HTML omitted -->
&ldquo;frequency analysis is very great when solving annoying monoalphabetic substitution ciphers&rdquo;</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="crypto-amajorproblem-200">Crypto: a-major-problem (200)</h1>
<hr>
<h2 id="challenge5">Challenge</h2>
<blockquote>
<p>A mysterious figure named Major Mnemonic has sent you the following set of words. Figure out what they mean!
<!-- raw HTML omitted --><!-- raw HTML omitted -->
&ldquo;Pave Pop Poke Pop Dutch Dozen Denim Deism Loot Thatch Pal Atheism Rough Ditch Tonal&rdquo;
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint: The words translate to numbers, which then translate to the flag.</p>
</blockquote>
<h2 id="solution4">Solution</h2>
<p>以下のWikiに従って、それぞれの数字を求めて、文字に変換するだけです。<!-- raw HTML omitted -->
<a href="https://en.wikipedia.org/wiki/Mnemonic_major_system"><a href="https://en.wikipedia.org/wiki/Mnemonic_major_system">https://en.wikipedia.org/wiki/Mnemonic_major_system</a></a></p>
<table>
<thead>
<tr>
<th align="left">単語</th>
<th align="center">数字</th>
<th align="center">文字</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Pave</td>
<td align="center">98</td>
<td align="center">b</td>
</tr>
<tr>
<td align="left">Pop</td>
<td align="center">99</td>
<td align="center">c</td>
</tr>
<tr>
<td align="left">Poke</td>
<td align="center">97</td>
<td align="center">a</td>
</tr>
<tr>
<td align="left">Pop</td>
<td align="center">99</td>
<td align="center">c</td>
</tr>
<tr>
<td align="left">Dutch</td>
<td align="center">16 (?)</td>
<td align="center">t</td>
</tr>
<tr>
<td align="left">Dozen</td>
<td align="center">102</td>
<td align="center">f</td>
</tr>
<tr>
<td align="left">Denim</td>
<td align="center">123</td>
<td align="center">{</td>
</tr>
<tr>
<td align="left">Deism</td>
<td align="center">103</td>
<td align="center">g</td>
</tr>
<tr>
<td align="left">Loot</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="left">Thatch</td>
<td align="center">16 (?)</td>
<td align="center">t</td>
</tr>
<tr>
<td align="left">Pal</td>
<td align="center">95</td>
<td align="center">_</td>
</tr>
<tr>
<td align="left">Atheism</td>
<td align="center">103</td>
<td align="center">g</td>
</tr>
<tr>
<td align="left">Rough</td>
<td align="center">48</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">Ditch</td>
<td align="center">16 (?)</td>
<td align="center">t</td>
</tr>
<tr>
<td align="left">Tonal</td>
<td align="center">125</td>
<td align="center">}</td>
</tr>
</tbody>
</table>
<p>ところどころ16が出てきちゃったけど、フラグフォーマットより&quot;t&rdquo; (bcac<!-- raw HTML omitted -->t<!-- raw HTML omitted -->f) に置き換えられるのがわかるので、フラグは<code>bcactf{g3t_g0t}</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="forensics-ofcourserachel-150">Forensics: of-course-rachel (150)</h1>
<hr>
<h2 id="challenge6">Challenge</h2>
<blockquote>
<p>Ugh, I had a really important file with the flag, but sadly it broke. My friend Rachel said that snapshots are good for backing up, and luckily I listened so here is my screenshot. Do you think you could help me put it back together?
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint: that's a lot to type in&hellip;</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>snapshot.zip (part1.png, part2.png, part3.png, part4.png, part5.png)</li>
</ul>
<h2 id="solution5">Solution</h2>
<p>ヒント<code>that's a lot to type in...</code>があんまりヒントになってない気がします^^; <!-- raw HTML omitted -->
16進数が書かれた画像ファイルがあるので、OCRで読み取って変換するだけです。
<!-- raw HTML omitted --><!-- raw HTML omitted -->
オンラインのをいくつか試しましたが、読み取り精度がイマイチですね。
タダのものに文句は言えないですが、「0」(ゼロ)が「O」(オー)になるのはともかく、「B」が「13」になったり、「D」が「1)」になったりしました。（気持ちはわからんでもないけど）
<!-- raw HTML omitted --><!-- raw HTML omitted -->
わたしは以下を使いましたけど、オススメするわけではないです。結構、手直ししました。
<!-- raw HTML omitted -->
<a href="https://ocr.space/"><a href="https://ocr.space/">https://ocr.space/</a></a>
<!-- raw HTML omitted --><!-- raw HTML omitted -->
デコードしたところ、Pythonコードが出てきたので、以下のようにファイルに保存してpython3で実行したらフラグが取れました。</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="forensics-theflagis-200">Forensics: the-flag-is (200)</h1>
<hr>
<h2 id="challenge7">Challenge</h2>
<blockquote>
<p>I have a flag! The flag is&hellip; wait&hellip; did my PDF editor not save the flag? OH NO! I remember typing it in, can you help me find it?
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint: There are two ways to view PDFs. One way is to view it with a PDF viewer. How else can you view a file?</p>
</blockquote>
<h2 id="solution6">Solution</h2>
<p>テキストエディタで開くと以下が見つかるので、ascii85 decodeをするだけです。</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>以下を使いました。<!-- raw HTML omitted -->
<a href="https://www.tools4noobs.com/online_tools/ascii85_decode/"><a href="https://www.tools4noobs.com/online_tools/ascii85_decode/">https://www.tools4noobs.com/online_tools/ascii85_decode/</a></a>
<!-- raw HTML omitted --><!-- raw HTML omitted -->
結果：BT /F1 16 Tf 100 700 Td (<code>bcactf{d0n7_4g3t_4b0u7_1nCr3Men74l_uPd473s}</code>) Tj ET</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="programming-11window-75">Programming: 1+1=window (75)</h1>
<hr>
<h2 id="challenge8">Challenge</h2>
<blockquote>
<p>hex+hex=hex</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>one.txt</li>
<li>two.txt</li>
</ul>
<h2 id="solution7">Solution</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/env python3</span>

<span class="k">for</span> <span class="n">one</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">one.txt</span><span class="s2">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s2">&#34;</span><span class="s2">r</span><span class="s2">&#34;</span><span class="p">)</span><span class="p">:</span>
    <span class="n">one_hex</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">two</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">two.txt</span><span class="s2">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s2">&#34;</span><span class="s2">r</span><span class="s2">&#34;</span><span class="p">)</span><span class="p">:</span>
    <span class="n">two_hex</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="p">)</span>

<span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">one_hex</span><span class="p">,</span> <span class="n">two_hex</span><span class="p">)</span><span class="p">]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">&#34;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><code>bcactf{1_h0p3_y0u_us3_pyth0n}</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="programming-bcastore-75">Programming: bca-store (75)</h1>
<hr>
<h2 id="challenge9">Challenge</h2>
<blockquote>
<p>You are a cashier for a small store that sells a few items. Coming up is the annual sale, and you really don't want to do that much math. So, being you, you decide to automate it.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Items:
<!-- raw HTML omitted -->
A: $45, no sale<!-- raw HTML omitted -->
B: $52, buy one get one 10% off<!-- raw HTML omitted -->
C: $67, buy one get one half off<!-- raw HTML omitted -->
D: $75, buy two get one free<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
Input:
<!-- raw HTML omitted -->
What the customer ordered, separated by spaces.<!-- raw HTML omitted -->
The amount the customer paid.<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
For example, C B B C A 250.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
The input file is attached. If we had the above twice, then you can use the following to test on your local machine:
<!-- raw HTML omitted --><!-- raw HTML omitted -->
input.txt:
<!-- raw HTML omitted -->
C B B C A 250<!-- raw HTML omitted -->
D A B B 250<!-- raw HTML omitted -->
D D D D D A B 390<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<code>$ cat input.txt | ./script.py</code>
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Your program should print the customer's change (i.e. return to stdout), if applicable, or -1 (the number) if they don't have enough money. The above example should result in:
<!-- raw HTML omitted --><!-- raw HTML omitted -->
5.70<!-- raw HTML omitted -->
31.20<!-- raw HTML omitted -->
-1<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
Round to the nearest hundredths place.<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
You should submit your answer as one string, with each input line's result separated by a space.<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
For example, the above output should be formatted as follows to be accepted:<!-- raw HTML omitted -->
<code>5.70 31.20 -1</code></p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>input.txt</li>
</ul>
<h2 id="solution8">Solution</h2>
<p>例が、<code>$ cat input.txt | ./script.py</code> となってて、なんとなくpythonで解くことを期待されているようだったので、勉強も兼ねてpythonでやりました。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">calc_B</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span><span class="o">=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">52</span> <span class="o">+</span> <span class="mi">52</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span> <span class="n">num</span> <span class="o">/</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">52</span> <span class="o">*</span> <span class="p">(</span><span class="n">num</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">52</span> <span class="o">*</span> <span class="n">num</span>

<span class="k">def</span> <span class="nf">calc_C</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span><span class="o">=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">67</span> <span class="o">+</span> <span class="mi">67</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span> <span class="n">num</span> <span class="o">/</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">67</span> <span class="o">*</span> <span class="p">(</span><span class="n">num</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">67</span> <span class="o">*</span> <span class="n">num</span>

<span class="k">def</span> <span class="nf">calc_D</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span><span class="o">=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">75</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span> <span class="n">num</span> <span class="o">/</span> <span class="mi">3</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">75</span> <span class="o">*</span> <span class="p">(</span><span class="n">num</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">75</span> <span class="o">*</span> <span class="p">(</span><span class="n">num</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)</span>


<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">readlines</span><span class="p">(</span><span class="p">)</span><span class="p">:</span>
    <span class="n">numA</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">numB</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">numC</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">numD</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">str_digit</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;</span><span class="s1">(</span><span class="s1">\</span><span class="s1">d+|</span><span class="s1">\</span><span class="s1">D+)</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
    <span class="n">items</span> <span class="o">=</span> <span class="n">str_digit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="p">)</span>
    <span class="n">paid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_digit</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="sa"></span><span class="s1">&#39;</span><span class="s1">A</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">numA</span> <span class="o">+</span><span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="sa"></span><span class="s1">&#39;</span><span class="s1">B</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">numB</span> <span class="o">+</span><span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="sa"></span><span class="s1">&#39;</span><span class="s1">C</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">numC</span> <span class="o">+</span><span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="sa"></span><span class="s1">&#39;</span><span class="s1">D</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">numD</span> <span class="o">+</span><span class="o">=</span> <span class="mi">1</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">45</span> <span class="o">*</span> <span class="n">numA</span> <span class="o">+</span> <span class="n">calc_B</span><span class="p">(</span><span class="n">numB</span><span class="p">)</span> <span class="o">+</span> <span class="n">calc_C</span><span class="p">(</span><span class="n">numC</span><span class="p">)</span> <span class="o">+</span> <span class="n">calc_D</span><span class="p">(</span><span class="n">numD</span><span class="p">)</span>
    <span class="c1"># == debug ==</span>
    <span class="c1"># print(&#34;paid = {}, total = {}, A = {}, B = {}, C = {}, D = {}&#34;.format(paid, total, numA, numB, numC, numD))</span>
    <span class="c1"># print(&#34;paid = {}, total = {}, A = {}, B = {}, C = {}, D = {}&#34;.format(paid, total, 45 * numA, calc_B(numB), calc_C(numC), calc_D(numD)))</span>
    <span class="c1"># continue</span>

    <span class="k">if</span> <span class="n">paid</span> <span class="o">&gt;</span><span class="o">=</span> <span class="n">total</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">{:.2f}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">paid</span> <span class="o">-</span> <span class="n">total</span><span class="p">)</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">&#34;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">-1</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">&#34;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2"> </span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">&#34;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><code>5.70 -1 1.00 75.00 -1 77.40 -1</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="programming-instructions-175">Programming: instructions (175)</h1>
<hr>
<h2 id="challenge10">Challenge</h2>
<blockquote>
<p>We intercepted a message between two agents from a terrorist group known as 0x4556494c. We think it might contain some useful information, so we'd like you to crack it. Here is the message.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
BEGIN TRANSMITION<!-- raw HTML omitted -->
Dear Agent Reffef,<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
I have attached the super secret plans for operation 0x576f726b206f6e207468652070757a7a6c652c2073746f702072656164696e672068657821.<!-- raw HTML omitted -->
You will need to decode it first though.<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
The rules are simple:<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
A line is &ldquo;viable&rdquo; if the length of a line is divisible by 3, and the line does not contain the `&amp;` character. <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
For every viable line, you will grab the `n`th character, <!-- raw HTML omitted -->
where `n` is the corresponding number at the top of the file (Counting from one!) <!-- raw HTML omitted -->
The first viable line will use the first number, etc.<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
Put all the letters together to find the answer!  <!-- raw HTML omitted -->
<!-- raw HTML omitted --></p>
</blockquote>
<ul>
<li>Agent Doposi<!-- raw HTML omitted -->
END TRANSMITION</li>
</ul>
<p>Attachment:</p>
<ul>
<li>flag.txt</li>
</ul>
<h2 id="solution9">Solution</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#</span><span class="cp">include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp"></span><span class="cp">#</span><span class="cp">include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="cp">#</span><span class="cp">define LINE_LEN     1000</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="n">pos</span><span class="p">[</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">tmp_buff</span><span class="p">[</span><span class="n">LINE_LEN</span><span class="p">]</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="o">*</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">FILE</span> <span class="o">*</span><span class="n">fp</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">find</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
	
	<span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">fp</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">flag.txt</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">r</span><span class="s">&#34;</span> <span class="p">)</span> <span class="p">)</span> <span class="o">=</span><span class="o">=</span> <span class="nb">NULL</span> <span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	
	<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span> <span class="n">fgets</span><span class="p">(</span> <span class="n">tmp_buff</span><span class="p">,</span> <span class="n">LINE_LEN</span><span class="p">,</span> <span class="n">fp</span> <span class="p">)</span> <span class="o">=</span><span class="o">=</span> <span class="nb">NULL</span> <span class="p">)</span> <span class="p">{</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">find</span> <span class="o">=</span> <span class="n">strstr</span><span class="p">(</span> <span class="n">tmp_buff</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">&amp;</span><span class="s">&#34;</span> <span class="p">)</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span> <span class="n">find</span> <span class="o">!</span><span class="o">=</span> <span class="nb">NULL</span> <span class="p">)</span> <span class="p">{</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">strlen</span><span class="p">(</span> <span class="n">tmp_buff</span> <span class="p">)</span> <span class="o">-</span> <span class="n">strlen</span><span class="p">(</span> <span class="sa"></span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span> <span class="p">)</span> <span class="p">)</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">=</span><span class="o">=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
			<span class="o">*</span><span class="p">(</span> <span class="n">tmp_buff</span> <span class="o">+</span> <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span> <span class="o">=</span> <span class="sa"></span><span class="sc">&#39;</span><span class="sc">\0</span><span class="sc">&#39;</span><span class="p">;</span>
			<span class="n">printf</span><span class="p">(</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">%s</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">tmp_buff</span> <span class="o">+</span> <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="p">;</span>
			<span class="n">i</span><span class="o">+</span><span class="o">+</span><span class="p">;</span>
			<span class="c1">// To prevent seg fault
</span><span class="c1"></span>			<span class="k">if</span> <span class="p">(</span> <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span><span class="o">=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">puts</span><span class="p">(</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">&#34;</span> <span class="p">)</span><span class="p">;</span>
	<span class="n">fclose</span><span class="p">(</span> <span class="n">fp</span> <span class="p">)</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>bcactf{f0110w_tH3_r00lz_&lt;3_l0ve_m3_pls}</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="programming-mannerofthpeaking-250">Programming: manner-of-thpeaking (250)</h1>
<hr>
<h2 id="challenge11">Challenge</h2>
<blockquote>
<p>Tho, I came Acroth thith therieth of inthturcthins, and thomething that thaid &ldquo;the key ith the attached litht of ATHCII printableth.&rdquo; Tho anywayth, here'th the inthtructhinth.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint1: Pardon my LITHP
<!-- raw HTML omitted -->
Hint2: Backthaltheth in printableth.txt are ethcape charachterth</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>printableth.txt</li>
<li>inthtructhins.txt</li>
</ul>
<p><!-- raw HTML omitted -->
以下がprintableth.txtの中身。（特殊文字だらけで表示が変になりそうなので、スクリーンショットにしてます。）<!-- raw HTML omitted -->
<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->
以下がinthtructhins.txtの中身。<!-- raw HTML omitted -->
cadadddddr, caddadddddr, caadddddr, caddadddddr, cadddddddddddddddddddadddddr, cadddddadddddr, caaddddddr, cadddddddddddadddr, cadadr, cadddddadr, cadddddddadr, caddddaddddr, caddddddddadr, caddddadr, cadddddadr, cadddadr, cadddadddddr, caddddaddddr, cadddddddddddddddadddddr, cadddddddddddddddddadddr, caadr, caddddddadddddr, cadddddddddddddddddadddr, caddddadr, caddddddddddddadddr, caddddddddddddadddddr, cadadr, cadddddddddddddadddddr, caddddddadddr, caddddaddddr, cadadr, cadddddadr, caddddaddddr, caddddadr, caddddddddddddddddddddddadddddr, cadddadr, caddddddddddddddddddadddr, caadr, caddddddddddddadddr, caddddadddddr, cadar, caddaddddddr</p>
<h2 id="solution10">Solution</h2>
<p>[ポイント１]<!-- raw HTML omitted -->
コンマ(,)で区切られた塊が一文字だと考えると、見えてきます。<!-- raw HTML omitted --></p>
<p>b : ca<!-- raw HTML omitted -->d<!-- raw HTML omitted -->a<!-- raw HTML omitted -->ddddd<!-- raw HTML omitted -->r<!-- raw HTML omitted -->
c : ca<!-- raw HTML omitted -->dd<!-- raw HTML omitted -->a<!-- raw HTML omitted -->ddddd<!-- raw HTML omitted -->r<!-- raw HTML omitted -->
a : caa<!-- raw HTML omitted -->ddddd<!-- raw HTML omitted -->r<!-- raw HTML omitted -->
c : ca<!-- raw HTML omitted -->dd<!-- raw HTML omitted -->a<!-- raw HTML omitted -->ddddd<!-- raw HTML omitted -->r<!-- raw HTML omitted -->
t : ca<!-- raw HTML omitted -->ddddddddddddddddddd<!-- raw HTML omitted -->a<!-- raw HTML omitted -->ddddd<!-- raw HTML omitted -->r<!-- raw HTML omitted -->
f : ca<!-- raw HTML omitted -->ddddd<!-- raw HTML omitted -->a<!-- raw HTML omitted -->ddddd<!-- raw HTML omitted -->r<!-- raw HTML omitted -->
{ : caa<!-- raw HTML omitted -->dddddd<!-- raw HTML omitted -->r<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->
[ポイント2]<!-- raw HTML omitted -->
printableth.txtの中身は、単純にASCII文字の並びなのに、ところどころ()でくくられてグループ化されています。
<!-- raw HTML omitted --><!-- raw HTML omitted -->
inthtructhins.txtに出てくる文字列の、2個目のaとrの間のdの数（<!-- raw HTML omitted -->オレンジ<!-- raw HTML omitted -->部分）、例えばbで言うとd=5ですけど、これは5番目の()のグループを見る、ということです。<!-- raw HTML omitted -->
1個目のaと2個目のaの間のdの数（<!-- raw HTML omitted -->レッド<!-- raw HTML omitted -->部分）は、グループの中の何番目の文字を見るか、ですね。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#</span><span class="cp">include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp"></span><span class="cp">#</span><span class="cp">include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="cp">#</span><span class="cp">define ON  1</span><span class="cp">
</span><span class="cp"></span><span class="cp">#</span><span class="cp">define OFF 0</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">char</span> <span class="n">printable</span><span class="p">[</span><span class="p">]</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span><span class="p">{</span><span class="sa"></span><span class="s">&#34;</span><span class="s"> !</span><span class="se">\&#34;</span><span class="s">#$%&amp;&#39;()*+,-./</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">0123456789</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">:;&lt;=&gt;?@</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">[</span><span class="se">\\</span><span class="s">]^_`</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">abcdefghijklmnopqrstuvwxyz</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">{|}~</span><span class="s">&#34;</span><span class="p">}</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">inthtructhins</span><span class="p">[</span><span class="p">]</span><span class="p">[</span><span class="mi">40</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="sa"></span><span class="s">&#34;</span><span class="s">cadadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddddddddddddddddddadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddddadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caaddddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddddddddddadddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddddadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddddddadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddaddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddddddadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddddadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddaddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddddddddddddddadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddddddddddddddddadddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddddadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddddddddddddddddadddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddddddddddadddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddddddddddadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddddddddddddadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddddadddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddaddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddddadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddaddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddddddddddddddddddddadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadddadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddddddddddddddddadddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caadr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddddddddddadddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddddadddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">cadar</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">caddaddddddr</span><span class="s">&#34;</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">eof</span><span class="s">&#34;</span><span class="p">}</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="o">*</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">op</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">flag_r</span><span class="p">,</span> <span class="n">flag_a</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span> <span class="n">op</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="p">;</span> <span class="n">op</span><span class="o">+</span><span class="o">+</span> <span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span> <span class="n">strcmp</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">inthtructhins</span><span class="p">[</span><span class="n">op</span><span class="p">]</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="p">,</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">eof</span><span class="s">&#34;</span> <span class="p">)</span> <span class="o">=</span><span class="o">=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">flag_r</span> <span class="o">=</span> <span class="n">OFF</span><span class="p">;</span>
		<span class="n">flag_a</span> <span class="o">=</span> <span class="n">OFF</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">flag_r</span> <span class="o">=</span><span class="o">=</span> <span class="n">OFF</span> <span class="p">;</span> <span class="n">i</span><span class="o">+</span><span class="o">+</span> <span class="p">)</span> <span class="p">{</span>
			<span class="k">switch</span> <span class="p">(</span> <span class="n">inthtructhins</span><span class="p">[</span><span class="n">op</span><span class="p">]</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="sa"></span><span class="sc">&#39;</span><span class="sc">r</span><span class="sc">&#39;</span><span class="o">:</span>
				<span class="n">flag_r</span> <span class="o">=</span> <span class="n">ON</span><span class="p">;</span>
				<span class="n">pos1</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="sa"></span><span class="sc">&#39;</span><span class="sc">a</span><span class="sc">&#39;</span><span class="o">:</span>
				<span class="k">if</span> <span class="p">(</span> <span class="n">a</span> <span class="o">=</span><span class="o">=</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
					<span class="n">pos2</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span>
					<span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">a</span><span class="o">+</span><span class="o">+</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="sa"></span><span class="sc">&#39;</span><span class="sc">d</span><span class="sc">&#39;</span><span class="o">:</span>
				<span class="n">d</span><span class="o">+</span><span class="o">+</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">default</span><span class="o">:</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">printf</span><span class="p">(</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">%c</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">printable</span><span class="p">[</span><span class="n">pos1</span><span class="p">]</span><span class="p">[</span><span class="n">pos2</span><span class="p">]</span> <span class="p">)</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">puts</span><span class="p">(</span> <span class="sa"></span><span class="s">&#34;</span><span class="s">&#34;</span> <span class="p">)</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>bcactf{L157_8453d_pR0gR4Mm1nG_15_4w3S0Me!}</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="quest-forthenightisdark1-150">Quest: for-the-night-is-dark-1 (150)</h1>
<hr>
<h2 id="challenge12">Challenge</h2>
<blockquote>
<p>Hello, traveler. Welcome to your quest. You must walk the Red Lord's shining path, guided by his shining stars. Here is a picture of those stars. A map if you will. May the Lord of Light give you wisdom.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
NOTE: As more heroes complete each stage of the quest, fewer points will be available to future teams.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint1: One per row, top to bottom.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint2: Maybe the brightness of the stars mean something?</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>starmap.bmp</li>
</ul>
<h2 id="solution11">Solution</h2>
<p>「青い空を見上げればいつもそこに白い猫」で開くと、赤色のところだけ星みたいなのが出てきました。</p>
<p>赤色 ビット1 <!-- raw HTML omitted -->
<!-- raw HTML omitted --></p>
<p>赤色 ビット2 <!-- raw HTML omitted -->
<!-- raw HTML omitted --></p>
<p>赤色だけ抽出でビットとして選択して、UTF-8でテキストの取り出しをすると、URLが取れました。<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<a href="http://rhllor.xyz/7h3fir31n0urh3ar75_d2VsY29tZSB0byBzdGVwIG9uZQ">http://rhllor.xyz/7h3fir31n0urh3ar75_d2VsY29tZSB0byBzdGVwIG9uZQ</a></p>
<p>アクセスするとフラグがもらえます。<!-- raw HTML omitted -->
<code>bcactf{gu1d3d_8y_574r5_QmVnaW5uaW5ncw}</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="quest-forthenightisdark2-150">Quest: for-the-night-is-dark-2 (150)</h1>
<hr>
<h2 id="challenge13">Challenge</h2>
<blockquote>
<p>This task can be found through solving the prior quest tasks.</p>
</blockquote>
<h2 id="solution12">Solution</h2>
<p>stage2.jsというのがあるので、中身を見てみます。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">$</span><span class="p">(</span><span class="s2">&#34;#target&#34;</span><span class="p">)</span><span class="p">.</span><span class="nx">submit</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">event</span> <span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&#34;#secret&#34;</span><span class="p">)</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="p">)</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">hash</span> <span class="o">==</span> <span class="s2">&#34;3758002ab24653af8d550c0c50473098&#34;</span><span class="p">)</span> <span class="p">{</span>
  	<span class="kd">var</span> <span class="nx">encode</span> <span class="o">=</span> <span class="s2">&#34;ÐßÏ½æ¦ ÐÞÙÖ©Ã»¤× ÃºªîÈ©¼×ÐÖËÕ§£¢Íç«ÖÉÌ±ÈÕÒßÊÕÅ&#34;</span>
	<span class="kd">var</span> <span class="nx">newstr</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
	<span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&#34;#secret&#34;</span><span class="p">)</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="p">)</span>
	<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">encode</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">newstr</span> <span class="o">+=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">encode</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">-</span> <span class="nx">key</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="o">%</span><span class="nx">key</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="p">)</span>
	<span class="p">}</span>
  	<span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="s2">&#34;/f&#34;</span> <span class="o">+</span> <span class="nx">newstr</span>
  <span class="p">}</span>

  <span class="nx">$</span><span class="p">(</span><span class="s2">&#34;#secret&#34;</span><span class="p">)</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
  <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>md5（3758002ab24653af8d550c0c50473098）の元の文字列は、<a href="https://crackstation.net/">rainbow table</a>で見つかりました。
<!-- raw HTML omitted -->
==&gt; darknight
<!-- raw HTML omitted -->
<code>bcactf{7h37ru7h15411w3h4v3_dGhlIGxpZ2h0IGluIG91ciBleWVz}</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="quest-forthenightisdark3-75">Quest: for-the-night-is-dark-3 (75)</h1>
<hr>
<h2 id="challenge14">Challenge</h2>
<blockquote>
<p>Keep on going</p>
</blockquote>
<h2 id="solution13">Solution</h2>
<p>ウェブアーカイブを見つけるだけです。<!-- raw HTML omitted -->
<a href="https://web.archive.org/web/20190614021723/http://rhllor.xyz/fl4m30fV3r1745burn5_Z2l2ZSBzdHJlbmd0aCB0byBoaXMgc3dvcmQ"><a href="https://web.archive.org/web/20190614021723/http://rhllor.xyz/fl4m30fV3r1745burn5_Z2l2ZSBzdHJlbmd0aCB0byBoaXMgc3dvcmQ">https://web.archive.org/web/20190614021723/http://rhllor.xyz/fl4m30fV3r1745burn5_Z2l2ZSBzdHJlbmd0aCB0byBoaXMgc3dvcmQ</a></a>
<!-- raw HTML omitted --><!-- raw HTML omitted -->
<code>bcactf{p33r1ng_1n70_7h3_p457_Ymxlc3NlZHZpZXc}</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="reversing-largepass-100">Reversing: large-pass (100)</h1>
<hr>
<h2 id="challenge15">Challenge</h2>
<blockquote>
<p>You've come across a USB stick in the middle of a parking lot. After taking it home, you plug it into a network-isolated, clean computer, and see a compiled program. Secrets are abound!
<!-- raw HTML omitted --><!-- raw HTML omitted -->
This problem is in a similar vein to basic-pass-2, another-pass, and so on.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
The flag is not in the bcactf{&hellip;} format.</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>large-linux</li>
<li>large-mac</li>
</ul>
<h2 id="solution14">Solution</h2>
<p>Ghidraで確認します。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="n">undefined8</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
  <span class="kt">long</span> <span class="n">in_FS_OFFSET</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">local_20</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">local_18</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">local_10</span><span class="p">;</span>
  
  <span class="n">local_10</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)</span><span class="p">(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">)</span><span class="p">;</span>
  <span class="n">local_18</span> <span class="o">=</span> <span class="mh">0x4cf7983ffb7741c8</span><span class="p">;</span>
  <span class="n">__printf_chk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="sa"></span><span class="s">&#34;</span><span class="s">Password: </span><span class="s">&#34;</span><span class="p">)</span><span class="p">;</span>
  <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">DAT_0010098f</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_20</span><span class="p">)</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">local_18</span> <span class="o">=</span><span class="o">=</span> <span class="n">local_20</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="sa"></span><span class="s">&#34;</span><span class="s">Correct password.</span><span class="s">&#34;</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="sa"></span><span class="s">&#34;</span><span class="s">Incorrect Password.</span><span class="s">&#34;</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">local_10</span> <span class="o">=</span><span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)</span><span class="p">(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">)</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
                    <span class="cm">/* WARNING: Subroutine does not return */</span>
  <span class="n">__stack_chk_fail</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><!-- raw HTML omitted -->
DAT_0010098fは、%ldになっているので、
<!-- raw HTML omitted -->
<!-- raw HTML omitted --></p>
<p>0x4cf7983ffb7741c8を10進数で入れてあげたらよさそうです。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="err">$</span> <span class="n">python</span>
<span class="o">&gt;&gt;</span><span class="o">&gt;</span> <span class="mh">0x4cf7983ffb7741c8</span>
<span class="mi">5546068866699313608</span>
</code></pre></td></tr></table>
</div>
</div><p><!-- raw HTML omitted -->
gdbでも同様の確認はできます。cmpしているところでBreak pointはって、レジスタを確認。</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>オンラインの16進数-&gt;10進数変換ツールだと、違う値（5546068866699313000）になったりします。</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted -->
Flag: <code>5546068866699313608</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="reversing-scratchthat-150">Reversing: scratch-that (150)</h1>
<hr>
<h2 id="challenge16">Challenge</h2>
<blockquote>
<p>I made a Guess the Flag game! It's in Scratch, what could be easier? <a href="https://scratch.mit.edu/projects/276674047/">Click here to access the game.</a>
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint1: What does &ldquo;See inside&rdquo; do?
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint2: There are four scripts: When flag clicked, Reset variables, Check flag, and Generate flag. Which one could possibly contain the flag?</p>
</blockquote>
<h2 id="solution15">Solution</h2>
<p>scrachのプロジェクトが保存できたので、自分のscrachアカウントを新規作成してプロジェクトを読み込みました。
<!-- raw HTML omitted --><!-- raw HTML omitted -->
あとは、flagの計算をしているところに、以下を追加して実行するだけです。</p>
<ul>
<li>show variable flag</li>
<li>stop all
<!-- raw HTML omitted -->
<!-- raw HTML omitted --></li>
</ul>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="reversing-anotherpass-200">Reversing: another-pass (200)</h1>
<hr>
<h2 id="challenge17">Challenge</h2>
<blockquote>
<p>Alright. Your friend John found this cool binary file on the Interwebz. Against all best practices, he downloaded it. Strange, it doesn't appear to be a virus. Because of the password prompt, you feel like it will lead to something important. Figure this one out!
<!-- raw HTML omitted --><!-- raw HTML omitted -->
WARNING: The flag for this problem may not be in the bcactf{&hellip;} format.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
The pass that gives &ldquo;correct&rdquo; will be the flag.</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>another-win.exe</li>
<li>another-mac</li>
<li>another-linux</li>
</ul>
<h2 id="solution16">Solution</h2>
<p>Ghidraで確認します。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="kt">void</span> <span class="nf">_checkInput</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">pcParm1</span><span class="p">)</span>

<span class="p">{</span>
  <span class="n">ulong</span> <span class="n">uVar1</span><span class="p">;</span>
  <span class="n">size_t</span> <span class="n">sVar2</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">local_20</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">local_19</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">local_18</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">local_14</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">local_10</span><span class="p">;</span>
  
  <span class="n">local_14</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_18</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_10</span> <span class="o">=</span> <span class="n">pcParm1</span><span class="p">;</span>
  <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">uVar1</span> <span class="o">=</span> <span class="n">SEXT48</span><span class="p">(</span><span class="n">local_18</span><span class="p">)</span><span class="p">;</span>
    <span class="n">sVar2</span> <span class="o">=</span> <span class="n">_strlen</span><span class="p">(</span><span class="n">local_10</span><span class="p">)</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sVar2</span> <span class="o">&lt;</span><span class="o">=</span> <span class="n">uVar1</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">_printf</span><span class="p">(</span><span class="sa"></span><span class="s">&#34;</span><span class="s">Incorrect.</span><span class="s">&#34;</span><span class="p">)</span><span class="p">;</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">local_19</span> <span class="o">=</span> <span class="n">local_10</span><span class="p">[</span><span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">local_18</span><span class="p">]</span><span class="p">;</span>
    <span class="n">_sscanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_19</span><span class="p">,</span><span class="sa"></span><span class="s">&#34;</span><span class="s">%d</span><span class="s">&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_20</span><span class="p">)</span><span class="p">;</span>   <span class="c1">//&lt;--- ここら辺がポイント
</span><span class="c1"></span>    <span class="n">local_14</span> <span class="o">=</span> <span class="n">local_20</span> <span class="o">+</span> <span class="n">local_14</span><span class="p">;</span>      <span class="c1">//&lt;--- ここら辺がポイント
</span><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">local_14</span> <span class="o">=</span><span class="o">=</span> <span class="mh">0x4b</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
    <span class="n">local_18</span> <span class="o">=</span> <span class="n">local_18</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">_printf</span><span class="p">(</span><span class="sa"></span><span class="s">&#34;</span><span class="s">Correct.</span><span class="s">&#34;</span><span class="p">)</span><span class="p">;</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>入力された文字を数字として受け取り、各数字を合計して75（0x4b）になればOKとしてます。</p>
<p><code>999999993</code>にしました。(9 x 8 + 3 = 75)</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="reversing-basicpass3-200">Reversing: basic-pass-3 (200)</h1>
<hr>
<h2 id="challenge18">Challenge</h2>
<blockquote>
<p>Ok, the sysadmin finally admits that maybe authentication should happen on a server. Can you just check everything really quick to make sure there aren't any problems now? He put some readouts for people who forget their passwords.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
nc challenges.ctfd.io 30133
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint: What happens if you put in parts that you know must be part of the flag? how can you use this to your advantage?</p>
</blockquote>
<h2 id="solution17">Solution</h2>
<p>ncで繋いで、適当なフラグを入れてみます。</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>合っていると1がつくようです。
<!-- raw HTML omitted --><!-- raw HTML omitted -->
以下のコードを書きました。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/env python</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">host</span> <span class="o">=</span> <span class="sa"></span><span class="s2">&#34;</span><span class="s2">challenges.ctfd.io</span><span class="s2">&#34;</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">30133</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="sa"></span><span class="s2">&#34;</span><span class="s2">abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_!?</span><span class="s2">&#34;</span><span class="p">:</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sa"></span><span class="s2">&#34;</span><span class="s2">&#34;</span>
    <span class="n">payload</span> <span class="o">+</span><span class="o">=</span> <span class="sa"></span><span class="s2">&#34;</span><span class="s2">bcactf{</span><span class="s2">&#34;</span>
    <span class="n">payload</span> <span class="o">+</span><span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="mi">30</span>
    <span class="n">payload</span> <span class="o">+</span><span class="o">=</span> <span class="sa"></span><span class="s2">&#34;</span><span class="s2">}</span><span class="s2">&#34;</span>
    <span class="k">print</span> <span class="n">payload</span>
    <span class="n">s</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span> <span class="sa"></span><span class="s2">&#34;</span><span class="s2">Enter the password.</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">payload</span> <span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">msg</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><!-- raw HTML omitted --><!-- raw HTML omitted -->
結果：</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>あとは、1が立っているところの文字だけ選ぶだけです。手動でやりました。</p>
<p><code>bcactf{y0u_4r3_4_m4573rm1nD!_Ym9vbGlu}</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="reversing-compression-200">Reversing: compression (200)</h1>
<hr>
<h2 id="challenge19">Challenge</h2>
<blockquote>
<p>A stranger on the internet is giving away his passwords. They claim they are encrypted, but you quickly realize that it is only compressed. You have to get hold of their passwords so that you can prove them wrong.
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint1: $ file {filename} tells you what type of file something is
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint2: 123 and 240 are hexdumps (not necessarily compression)</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>999</li>
</ul>
<h2 id="solution18">Solution</h2>
<p>面倒くさいだけで、根気で解ける問題です。</p>
<p>スクリプトかなんかでできたら、楽なんでしょうけど、手動でやりました。</p>
<p>コマンドヒストリーの一部です。</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>hexdumpのテキスト アウトプットのやつは、<code>xxd -r</code>で解凍できます。</p>
<p><code>bcactf{A_l0t_0f_c0mPr3s510n}</code></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
ここから下はイベント終了後に行った復習です。</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h1 id="forensics-wavey-150">Forensics: wavey (150)</h1>
<hr>
<h2 id="challenge20">Challenge</h2>
<blockquote>
<p>My friend sent me his new mixtape, but honestly I don't think it's that good. Can you take a look at it and figure out what's going on?
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Hint: He specifically described it as wavey&hellip;</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>straightfire.wav</li>
</ul>
<h2 id="solution19">Solution</h2>
<p>正直、ヒントの意味がわからなかったです。waveyでいろいろ検索したりもした。。。
<!-- raw HTML omitted --><!-- raw HTML omitted -->
スペクトラムを見ると、視覚的にフラグが見えるようです。
<!-- raw HTML omitted --><!-- raw HTML omitted -->
Audacityでやってみました。
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
左のとこのファイル名（straightfire）が出ているところがプルダウンになってて、デフォルトだとWaveformだけど、そこでSpectrogramを選ぶとこれが出てきます。</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted -->
(2019-09-23)</p>
<h1 id="forensics-onepunchzip-250">Forensics: one-punch-zip (250)</h1>
<hr>
<h2 id="challenge21">Challenge</h2>
<blockquote>
<p>One Punch Man seemed to have lost the password to his super secret archive. Can you help him crack it?</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>opm.png</li>
<li>superSecure.zip（パスワード不明）</li>
</ul>
<h2 id="solution20">Solution</h2>
<p>Writeupを参照されてもらって、fcrackzipというコマンドで解けることがわかりました。</p>
<p>考えてみたら、wordlistがあればパスワード付きのZipはCrackできるわけだし、別のファイルが添付されているということはそこからwordlistを生成すればいいということですもんね。</p>
<p>zip2johnでも同じことができるかやってみました。</p>
<pre><code>root@kali:~/BCACTF# strings opm.png &gt; opm_wordlist.txt


root@kali:~/BCACTF# john hash.txt --wordlist=opm_wordlist.txt
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
w\8VH&quot;$.         (superSecure.zip/flag.txt)   &lt;--- パスワード出てきた！
1g 0:00:00:00 DONE (2019-09-23 09:34) 100.0g/s 540900p/s 540900c/s 540900C/s Po$,c..IEND
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed


root@kali:~/BCACTF# unzip superSecure.zip 
Archive:  superSecure.zip
[superSecure.zip] flag.txt password: 
 extracting: flag.txt                


root@kali:~/BCACTF# cat flag.txt 
bcactf{u5ing_4ll_string5_0f_1mag3_@s_dictionary?}
</code></pre><p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<hr>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">きゃぷあめ</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2019-09-23
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="https://captureamerica.github.io/writeups/tags/ctf/">CTF</a>
          <a href="https://captureamerica.github.io/writeups/tags/reviewed/">Reviewed</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="https://captureamerica.github.io/writeups/post/isitdtu_ctf_2019_quals/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">ISITDTU 2019 quals Writeup</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="https://captureamerica.github.io/writeups/post/flagctf_2019/">
            <span class="next-text nav-default">flagCTF Writeup</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://github.com/CaptureAmerica/" class="iconfont icon-github" title="github"></a>
  <a href="https://captureamerica.github.io/writeups/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">きゃぷあめ</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://captureamerica.github.io/writeups/dist/even.26188efa.min.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-104910699-2', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>
