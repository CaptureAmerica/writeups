<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Rooters CTF 2019 Writeup - CTF Writeups</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="きゃぷあめ" /><meta name="description" content="URL: https://rootersctf.in/ picoCTF 2019の直後でほとんど時間がなかったですが、ちょっとだけやりました。 後日、復習もやりました（偉い）。 [Forensics]: You Can&amp;rsquo;t See Me Challenge See for yourself Attachments: youcantseeme.pdf Solution 100 ページ" /><meta name="keywords" content="CTF, Writeup, captureamerica, picoCTF" />



<meta name="google-site-verification" content="PqctLWZQttGzxXVupWuIt2HWuBI8cvN1z07ETpxA2dw" />


<meta name="generator" content="Hugo 0.55.6 with theme even" />


<link rel="canonical" href="https://captureamerica.github.io/writeups/post/rootersctf_2019/" />
<link rel="apple-touch-icon" sizes="180x180" href="https://captureamerica.github.io/writeups/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://captureamerica.github.io/writeups/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://captureamerica.github.io/writeups/favicon-16x16.png">
<link rel="manifest" href="https://captureamerica.github.io/writeups/manifest.json">
<link rel="mask-icon" href="https://captureamerica.github.io/writeups/safari-pinned-tab.svg" color="#5bbad5">


<link href="https://captureamerica.github.io/writeups/dist/even.c2a46f00.min.css" rel="stylesheet">



<meta property="og:title" content="Rooters CTF 2019 Writeup" />
<meta property="og:description" content="URL: https://rootersctf.in/ picoCTF 2019の直後でほとんど時間がなかったですが、ちょっとだけやりました。 後日、復習もやりました（偉い）。 [Forensics]: You Can&rsquo;t See Me Challenge See for yourself Attachments: youcantseeme.pdf Solution 100 ページ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://captureamerica.github.io/writeups/post/rootersctf_2019/" />
<meta property="article:published_time" content="2019-10-14T16:00:00&#43;09:00"/>
<meta property="article:modified_time" content="2019-10-20T11:00:00&#43;09:00"/>

<meta itemprop="name" content="Rooters CTF 2019 Writeup">
<meta itemprop="description" content="URL: https://rootersctf.in/ picoCTF 2019の直後でほとんど時間がなかったですが、ちょっとだけやりました。 後日、復習もやりました（偉い）。 [Forensics]: You Can&rsquo;t See Me Challenge See for yourself Attachments: youcantseeme.pdf Solution 100 ページ">


<meta itemprop="datePublished" content="2019-10-14T16:00:00&#43;09:00" />
<meta itemprop="dateModified" content="2019-10-20T11:00:00&#43;09:00" />
<meta itemprop="wordCount" content="2074">



<meta itemprop="keywords" content="CTF,Reviewed," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Rooters CTF 2019 Writeup"/>
<meta name="twitter:description" content="URL: https://rootersctf.in/ picoCTF 2019の直後でほとんど時間がなかったですが、ちょっとだけやりました。 後日、復習もやりました（偉い）。 [Forensics]: You Can&rsquo;t See Me Challenge See for yourself Attachments: youcantseeme.pdf Solution 100 ページ"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="https://captureamerica.github.io/writeups/" class="logo">CTF Writeups</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="https://captureamerica.github.io/writeups/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="https://captureamerica.github.io/writeups/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="https://captureamerica.github.io/writeups/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="https://captureamerica.github.io/writeups/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="https://captureamerica.github.io/writeups/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="https://captureamerica.github.io/writeups/" class="logo">CTF Writeups</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/about/">About</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Rooters CTF 2019 Writeup</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-10-14 </span>
        <div class="post-category">
            <a href="https://captureamerica.github.io/writeups/categories/ctf/"> CTF </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#forensics-you-can-t-see-me">[Forensics]: You Can&rsquo;t See Me</a>
<ul>
<li><a href="#challenge">Challenge</a></li>
<li><a href="#solution">Solution</a></li>
</ul></li>
<li><a href="#forensics-find-the-pass">[Forensics]: Find The Pass</a>
<ul>
<li><a href="#challenge-1">Challenge</a></li>
<li><a href="#solution-1">Solution</a></li>
</ul></li>
<li><a href="#forensics-luna-3">[Forensics]: Luna - 3</a>
<ul>
<li><a href="#challenge-2">Challenge</a></li>
<li><a href="#solution-2">Solution</a></li>
</ul></li>
<li><a href="#forensics-frames-per-story">[Forensics]: Frames per Story</a>
<ul>
<li><a href="#challenge-3">Challenge</a></li>
<li><a href="#solution-3">Solution</a></li>
</ul></li>
<li><a href="#forensics-mind-awake-body-asleep">[Forensics]: Mind Awake Body Asleep!</a>
<ul>
<li><a href="#challenge-4">Challenge</a></li>
<li><a href="#solution-4">Solution</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<p>URL: <a href="https://rootersctf.in/">https://rootersctf.in/</a>
<br /><br />
picoCTF 2019の直後でほとんど時間がなかったですが、ちょっとだけやりました。</p>

<p>後日、復習もやりました（偉い）。</p>

<p><br /><br /></p>

<h2 id="forensics-you-can-t-see-me">[Forensics]: You Can&rsquo;t See Me</h2>

<hr />

<h3 id="challenge">Challenge</h3>

<blockquote>
<p>See for yourself</p>
</blockquote>

<p>Attachments:</p>

<ul>
<li>youcantseeme.pdf</li>
</ul>

<p><br /></p>

<h3 id="solution">Solution</h3>

<p>100 ページくらい真っ白が続くPDFが与えられます。</p>

<p>やったこと：</p>

<ul>
<li>pdf-parser.py<br /></li>
<li>pdfid.py<br /></li>
<li>Adobe Reader（特定のページになんかしらテキストっぽいのがあるのがわかるんですが、フォントの色の変え方がわかんなかったです。）<br /></li>
<li>Libre Office (少しずつフォントの色は変えられたんですが、全ページまとめてやる方法がわかんなかったです。)<br /></li>
<li>PDFStreamDumper (しばらく使わないうちに、起動がうまくいかなくなってた。。。)</li>
</ul>

<p><br />
以下でフラグをゲットしました。</p>

<ul>
<li>pdftotext -f 16 youcantseeme.pdf text.txt</li>
</ul>

<p>(16を指定したのは、最初に見つけたテキストが16ページだったからです。)</p>

<p>Flag: <code>rooters{Ja1_US1CT}ctf</code></p>

<p><br /><br />
<br /><br /></p>

<h2 id="forensics-find-the-pass">[Forensics]: Find The Pass</h2>

<hr />

<h3 id="challenge-1">Challenge</h3>

<blockquote>
<p>Find the admin Password. Put the flag in rooters{}ctf</p>
</blockquote>

<p>Attachments:</p>

<ul>
<li>inc0gnito.cap (inc0gnito.pcapにリネームしました)</li>
</ul>

<p><br /></p>

<h3 id="solution-1">Solution</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></pre></td>
<td class="lntd">
<pre class="chroma"># aircrack-ng inc0gnito.pcap

                                                      Aircrack-ng 1.5.2 


                                         [00:00:01] Tested 50922 keys (got 20006 IVs)

   KB    depth   byte(vote)
    0    0/  1   FF(32256) CE(25856) 0F(25600) 07(24832) 59(24832) 73(24576) 7B(24320) CC(24320) F5(24320) 
    1   41/ 54   00(22272) 11(22016) 1E(22016) 25(22016) 33(22016) 3F(22016) 52(22016) 64(22016) 88(22016) 
    2   11/ 19   AD(23808) EB(23808) F4(23808) 06(23808) 5F(23552) 8A(23552) 98(23552) 29(23552) 58(23296) 
    3    2/  5   BE(26112) 58(25600) A7(25600) EA(25088) BF(24320) 5C(24064) 70(24064) B9(24064) BE(24064) 
    4    0/ 10   EF(28928) 8F(27392) 30(27392) BF(26112) AD(25856) 6A(25856) 04(25344) 19(25344) C5(24832) 

                         KEY FOUND! [ FF:DE:AD:BE:EF ] 
	Decrypted correctly: 100%</pre></td></tr></table>
</div>
</div>
<p>Wireshark &gt; Protocols &gt; IEEE 802.11 &gt; Decryption KeysでWEP Keyを設定して復号します。</p>

<p>文字列 &ldquo;admin&rdquo; をサーチしたら、Basic Authの箇所 (Frame #2209057) がありました。</p>

<pre>
Credentials: admin:blu3_c0rp_p4ss
</pre>

<p>Flag: <code>rooters{blu3_c0rp_p4ss}ctf</code></p>

<p><br /><br />
<br /><br /></p>

<h2 id="forensics-luna-3">[Forensics]: Luna - 3</h2>

<hr />

<h3 id="challenge-2">Challenge</h3>

<blockquote>
<p>Luna - 3 is sending some images of the far side of the moon we need to show the world the unseen part of the moon help us retrieve the images.</p>
</blockquote>

<p>Attachments:</p>

<ul>
<li>recv_13.10.1959.wav</li>
</ul>

<p><br /></p>

<h3 id="solution-2">Solution</h3>

<p>picoCTF 2019で出てきたm00nwalkと同じ問題です。</p>

<p>RX-SSTV というツールを使いました。<br />
<a href="http://users.belgacom.net/hamradio/rxsstv.htm">http://users.belgacom.net/hamradio/rxsstv.htm</a></p>

<p><img src="https://captureamerica.github.io/writeups/img/Luna3.PNG" alt="Luna3.PNG"></p>

<p>なんて書いてあるのか、よく見えないけどね。。。</p>

<p>Flag: <code>rooters{Looq_L1x3_Lun4-3}ctf</code> (予想)</p>

<p><br /><br />
<br /><br />
<img src="https://captureamerica.github.io/writeups/img/orange_bar.png" alt="orange_bar.png">
<br />
ここから下はCTF終了後に行った復習です。（他の方のWriteupとか参照してます。）</p>

<p><br /><br /></p>

<h2 id="forensics-frames-per-story">[Forensics]: Frames per Story</h2>

<hr />

<h3 id="challenge-3">Challenge</h3>

<blockquote>
<p>Finally, Toby is out of the frames. I hope he never returns again.</p>
</blockquote>

<p>Attachments:</p>

<ul>
<li>結構な数のjpegファイル</li>
</ul>

<p><br /></p>

<h3 id="solution-3">Solution</h3>

<p>exiftoolをかけると、Comment欄に少しずつ文字が入っているのがわかるので、全ファイルに対してexiftoolをかけて、がっちゃんこします。</p>

<table><tr><td>
<b>$ exiftool * | grep Comment | cut -d: -f2 | tr -d "\n" ; echo </b><br />
 MICHAEL right Jim, your quarterlies look very good. How the thing is going at the library?JIM Oh I told you couldn't close it soMICHAEL So you've come to the master for guidance? (imitating) Is http ny.cc/rosvdz this what you're saying grass hopper?JIM Actually you called me in here, but ye ah.MICHAEL All right, well let me show you how it's done. h ttp c/rosvdz (gets on phone) Yes, I liked to speak to your office manager please. Yes hello this is Michael Scott, I am the regional manager of Dunder Mifflin paper products. Just wanted to talk to you, manager-on- manager. (cut to the office and cut back) All right done deal, thank you very much sir, you're a gentleman and a scholar. Oh I'm sorry, ok, I'm sorry, my mistake. (hangs up) That was a woman I was talking to she had a very low voice. Probably a smoker. So, so that's the way it's done. Michael the camera) I've been in Dundler Mifflin for twelve years, the last four as regional manager. If you want to come through here, (opens the door to the main office) so we have the entire floor, so this is my kingdom, as far as the eye can see, ah this is our receptionist Pam. (goes to the recep tionist) Pam, Pam Pam! http tiny.cc/rosv dz Pam Beesly. Pam has been with us for' for ever, Lavc57.70.100
</td></tr></table>

<p><br />
URLっぽいの（http ny.cc/rosvdz）があるのでアクセスしてみると、final.pngが手に入ります。</p>

<p>（ここまでは自力でいけました）</p>

<p><br />
final.pngを開いて、よーーく目を凝らすと、変なデータが見つかります。（オレンジで囲ったところ）</p>

<p><img src="https://captureamerica.github.io/writeups/img/rooters_final.png" alt="rooters_final.png"></p>

<p>いやー、これはわからんよな。。。</p>

<p><br />
Previewで拡大、選択、コピー、New from Clipboardをして、別ファイルとして保存します。</p>

<p><img src="https://captureamerica.github.io/writeups/img/rooters_final2.png" alt="rooters_final2.png"></p>

<p><br />
「青い空を見上げればいつもそこに白い猫」で開いて、ビット抽出前バイト列を確認します。
<img src="https://captureamerica.github.io/writeups/img/rooters_final3.png" alt="rooters_final3.png"></p>

<p>Flag: <code>rooters{WHY_4R3_TH3_W4Y_TH4T_Y0U_4R3!}ctf</code></p>

<p><br /><br />
<br /><br /></p>

<h2 id="forensics-mind-awake-body-asleep">[Forensics]: Mind Awake Body Asleep!</h2>

<hr />

<h3 id="challenge-4">Challenge</h3>

<blockquote>
<p>Everything visible has a flip side, like a coin.</p>
</blockquote>

<p>Attachments:</p>

<ul>
<li>challenge.wav</li>
</ul>

<p><br /></p>

<h3 id="solution-4">Solution</h3>

<p>challenge.wavを再生すると、誰かがモニャモニャ喋っていて、ほんとに眠たくなるファイルでした。</p>

<p>とりあえず、audacityでスペクトラムとか見てみましたが、何も見つからず。</p>

<p><br />
こういうやつは、LSBをチェックするのがいいらしいです。</p>

<p>LSBを取り出すやつは、picoCTF 2018 の LoadSomeBits で以前書いたコードがあったので、それを流用しました。</p>

<p>いちおう、以下が以前書いたWriteupです。<br />
<a href="https://captureamerica.github.io/writeups/post/picoctf_2018/">https://captureamerica.github.io/writeups/post/picoctf_2018/</a></p>

<p>今後も使うことあるかもしれないので、ファイル名を引き数に取るようにしておきました。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-C" data-lang="C"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C" data-lang="C"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">sub</span><span class="p">(</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fname</span> <span class="p">)</span>
<span class="p">{</span>
	<span class="n">FILE</span> <span class="o">*</span><span class="n">fp</span><span class="p">;</span>
	<span class="kt">int</span>  <span class="n">c</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">fp</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span> <span class="n">fname</span><span class="p">,</span> <span class="s">&#34;rb&#34;</span> <span class="p">)</span> <span class="p">)</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span> <span class="p">{</span>
		<span class="n">perror</span><span class="p">(</span> <span class="s">&#34;Can&#39;t fopen&#34;</span> <span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">offset</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
		<span class="n">fgetc</span><span class="p">(</span> <span class="n">fp</span> <span class="p">);</span>
	<span class="p">}</span>

	<span class="n">i</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
	<span class="n">ch</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span> <span class="p">(</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fgetc</span><span class="p">(</span> <span class="n">fp</span> <span class="p">)</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">EOF</span> <span class="p">)</span> <span class="p">{</span>
		<span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">;</span>
		<span class="n">ch</span> <span class="o">=</span> <span class="n">ch</span> <span class="o">|</span> <span class="p">(</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">);</span>
		<span class="n">i</span><span class="o">--</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">ch</span> <span class="o">&gt;=</span> <span class="mh">0x20</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">ch</span> <span class="o">&lt;=</span> <span class="mh">0x7e</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
				<span class="n">printf</span><span class="p">(</span> <span class="s">&#34;%c&#34;</span><span class="p">,</span> <span class="n">ch</span> <span class="p">);</span>
			<span class="p">}</span>
			<span class="n">i</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
			<span class="n">ch</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">);</span>
        <span class="n">fclose</span><span class="p">(</span> <span class="n">fp</span> <span class="p">);</span>
	
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span> <span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span> <span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span> <span class="s">&#34;Usage: lsb.o filename</span><span class="se">\n</span><span class="s">&#34;</span> <span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
		<span class="n">sub</span><span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p><br />
出力がやたらと多いので、もうちょっと改良した方がいいかもだけど。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ ./lsb.o challenge.wav | fold -120 | grep -i http
-@@RMr. Robot is an American drama thriller television series created by Sam Esmail. http://tiny.cc/72nwdz##############</pre></td></tr></table>
</div>
</div>
<p>長い文字列が1行で出てくるので、foldで適当に区切って、その中で&rdquo;http&rdquo;やら&rdquo;ctf&rdquo;やらのキーワードになりそうなものをサーチする感じですかね。</p>

<p><br />
見つかった <a href="http://tiny.cc/72nwdz">http://tiny.cc/72nwdz</a> にアクセスすると、newというテキストファイルが入手できます。</p>

<pre>
$ file new 
new: ASCII text, with very long lines, with no line terminators

$ cat new | fold -32 | tail -n 4 ; echo
81c9a9001031b0000031b00000379584
0790000000457e3cec00000060800610
00003950000025448494d0000000a0a1
a0d074e40598
</pre>

<p><br />
この末尾の文字列から、PNGヘッダ(89 50 4E 47 0D 0A 1A 0A)が思いつくかどうかと言われたら、普通思いつかないですよね。</p>

<p>問題文にある<code>flip</code>でそれに気づくかどうかかな。</p>

<p><br />
リバースしてバイナリとして保存します。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ python -c &#39;import binascii; open(&#34;output&#34;, &#34;wb&#34;).write(binascii.unhexlify(open(&#34;new&#34;, &#34;rb&#34;).read()[::-1]))&#39;
$ file output
output: PNG image data, 1427 x 352, 8-bit/color RGBA, non-interlaced</pre></td></tr></table>
</div>
</div>
<p><img src="https://captureamerica.github.io/writeups/img/rooters_python_is_awesome.png" alt="rooters_python_is_awesome.png"></p>

<p>Flag: <code>rooters{pyth0n_is_aw3s0m3}ctf</code></p>

<p><br /><br />
<br /><br /></p>

<hr />

<p><br /><br />
<br /><br /></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">きゃぷあめ</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2019-10-20
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="https://captureamerica.github.io/writeups/tags/ctf/">CTF</a>
          <a href="https://captureamerica.github.io/writeups/tags/reviewed/">Reviewed</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="https://captureamerica.github.io/writeups/post/cryptix_ctf_2019/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Cryptix CTF 2019 Writeup</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="https://captureamerica.github.io/writeups/post/picoctf_2019_forensics/">
            <span class="next-text nav-default">picoCTF 2019 Writeup (Forensics)</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://github.com/CaptureAmerica/" class="iconfont icon-github" title="github"></a>
  <a href="https://captureamerica.github.io/writeups/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2019 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">きゃぷあめ</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  
<script type="text/javascript" src="https://captureamerica.github.io/writeups/dist/even.26188efa.min.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-104910699-2', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>
