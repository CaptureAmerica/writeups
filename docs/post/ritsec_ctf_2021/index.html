<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>RITSEC CTF 2021 Writeup - CTF フラxxグゲット</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="CaptureAmerica @ CTF フラxxグゲット" /><meta name="description" content="URL: https://ctf.ritsec.club/challenges 2235ポイントで、最終順位は128番でした。 以下は、チャレンジ一覧です。Unlockできてないやつも、もしかしたらあるかもです。 結果的" /><meta name="keywords" content="CTF, Writeup, captureamerica, picoCTF" />



<meta name="google-site-verification" content="PqctLWZQttGzxXVupWuIt2HWuBI8cvN1z07ETpxA2dw" />


<meta name="generator" content="Hugo 0.74.2 with theme even" />


<link rel="canonical" href="https://captureamerica.github.io/writeups/post/ritsec_ctf_2021/" />
<link rel="apple-touch-icon" sizes="180x180" href="https://captureamerica.github.io/writeups/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://captureamerica.github.io/writeups/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://captureamerica.github.io/writeups/favicon-16x16.png">
<link rel="manifest" href="https://captureamerica.github.io/writeups/manifest.json">
<link rel="mask-icon" href="https://captureamerica.github.io/writeups/safari-pinned-tab.svg" color="#5bbad5">



<link href="https://captureamerica.github.io/writeups/sass/main.min.2e81bbed97b8b282c1aeb57488cc71c8d8c8ec559f3931531bd396bf31e0d4dd.css" rel="stylesheet">



<meta property="og:title" content="RITSEC CTF 2021 Writeup" />
<meta property="og:description" content="URL: https://ctf.ritsec.club/challenges 2235ポイントで、最終順位は128番でした。 以下は、チャレンジ一覧です。Unlockできてないやつも、もしかしたらあるかもです。 結果的" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://captureamerica.github.io/writeups/post/ritsec_ctf_2021/" />
<meta property="article:published_time" content="2021-04-13T13:00:00+09:00" />
<meta property="article:modified_time" content="2021-04-13T18:00:00+09:00" />
<meta itemprop="name" content="RITSEC CTF 2021 Writeup">
<meta itemprop="description" content="URL: https://ctf.ritsec.club/challenges 2235ポイントで、最終順位は128番でした。 以下は、チャレンジ一覧です。Unlockできてないやつも、もしかしたらあるかもです。 結果的">
<meta itemprop="datePublished" content="2021-04-13T13:00:00&#43;09:00" />
<meta itemprop="dateModified" content="2021-04-13T18:00:00&#43;09:00" />
<meta itemprop="wordCount" content="3620">



<meta itemprop="keywords" content="CTF," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="RITSEC CTF 2021 Writeup"/>
<meta name="twitter:description" content="URL: https://ctf.ritsec.club/challenges 2235ポイントで、最終順位は128番でした。 以下は、チャレンジ一覧です。Unlockできてないやつも、もしかしたらあるかもです。 結果的"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="https://captureamerica.github.io/writeups/" class="logo">CTF Writeups</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="https://captureamerica.github.io/writeups/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="https://captureamerica.github.io/writeups/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="https://captureamerica.github.io/writeups/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="https://captureamerica.github.io/writeups/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="https://captureamerica.github.io/writeups/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="https://captureamerica.github.io/writeups/" class="logo">CTF Writeups</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">RITSEC CTF 2021 Writeup</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-04-13 </span>
        <div class="post-category">
            <a href="https://captureamerica.github.io/writeups/categories/ctf/"> CTF </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#rev-snek-100-points">[Rev]: snek (100 points)</a>
      <ul>
        <li><a href="#challenge">Challenge</a></li>
        <li><a href="#solution">Solution</a></li>
      </ul>
    </li>
    <li><a href="#forensics-1597-100-points">[Forensics]: 1597 (100 points)</a>
      <ul>
        <li><a href="#challenge-1">Challenge</a></li>
        <li><a href="#solution-1">Solution</a></li>
      </ul>
    </li>
    <li><a href="#forensics-fysa-100-points">[Forensics]: FYSA (100 points)</a>
      <ul>
        <li><a href="#challenge-2">Challenge</a></li>
        <li><a href="#solution-2">Solution</a></li>
      </ul>
    </li>
    <li><a href="#forensics-parcel-200-points">[Forensics]: Parcel (200 points)</a>
      <ul>
        <li><a href="#challenge-3">Challenge</a></li>
        <li><a href="#solution-3">Solution</a></li>
      </ul>
    </li>
    <li><a href="#forensics-blob-200-points">[Forensics]: Blob (200 points)</a>
      <ul>
        <li><a href="#challenge-4">Challenge</a></li>
        <li><a href="#solution-4">Solution</a></li>
      </ul>
    </li>
    <li><a href="#forensics-pleaseclickallthethings-1-begineersritsechtml-150-points">[Forensics]: PleaseClickAlltheThings 1: BegineersRITSEC.html (150 points)</a>
      <ul>
        <li><a href="#challenge-5">Challenge</a></li>
        <li><a href="#solution-5">Solution</a></li>
      </ul>
    </li>
    <li><a href="#forensics-pleaseclickallthethings-2-gandcrab_ursnif-200-points">[Forensics]: PleaseClickAlltheThings 2: GandCrab_Ursnif (200 points)</a>
      <ul>
        <li><a href="#challenge-6">Challenge</a></li>
        <li><a href="#solution-6">Solution</a></li>
      </ul>
    </li>
    <li><a href="#forensics-please-click-all-the-things-3-iceid-350-points">[Forensics]: Please Click All the Things 3: IceID (350 points)</a>
      <ul>
        <li><a href="#challenge-7">Challenge</a></li>
        <li><a href="#solution-7">Solution</a></li>
      </ul>
    </li>
    <li><a href="#forensics-inception-ctf-dream-1-100-points">[Forensics]: Inception CTF: Dream 1 (100 points)</a>
      <ul>
        <li><a href="#challenge-8">Challenge</a></li>
        <li><a href="#solution-8">Solution</a></li>
      </ul>
    </li>
    <li><a href="#forensics-inception-ctf-dream-2-225-points">[Forensics]: Inception CTF: Dream 2 (225 points)</a>
      <ul>
        <li><a href="#challenge-9">Challenge</a></li>
        <li><a href="#solution-9">Solution</a></li>
      </ul>
    </li>
    <li><a href="#forensics-inception-ctf-dream-3-200-points">[Forensics]: Inception CTF: Dream 3 (200 points)</a>
      <ul>
        <li><a href="#challenge-10">Challenge</a></li>
        <li><a href="#solution-10">Solution</a></li>
      </ul>
    </li>
    <li><a href="#stego-inception-ctf-dream-4-200-points">[Stego]: Inception CTF: Dream 4 (200 points)</a>
      <ul>
        <li><a href="#challenge-11">Challenge</a></li>
        <li><a href="#solution-11">Solution</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <div class='align-right'>
<a href="https://translate.google.com/translate?hl=en&sl=ja&tl=en&u=https%3A%2F%2Fcaptureamerica.github.io%2Fwriteups%2Fpost%2Fritsec_ctf_2021%2F">
<img src="https://captureamerica.github.io/writeups/img/En.png" alt="English">
</a>
</div>
<p>URL: <a href="https://ctf.ritsec.club/challenges">https://ctf.ritsec.club/challenges</a>
<br /><br /></p>
<p>2235ポイントで、最終順位は128番でした。</p>
<img src="https://captureamerica.github.io/writeups/img/ritsec_ctf_2021_score1.png" alt="ritsec_ctf_2021_score1.png">
<p><br /></p>
<img src="https://captureamerica.github.io/writeups/img/ritsec_ctf_2021_score2.png" alt="ritsec_ctf_2021_score2.png">
<p><br /><br />
以下は、チャレンジ一覧です。Unlockできてないやつも、もしかしたらあるかもです。</p>
<p>結果的に、Forensicsばっかりになってしまいました。</p>
<p><img src="https://captureamerica.github.io/writeups/img/ritsec_ctf_2021_chall_list1.png" alt="ritsec_ctf_2021_chall_list1.png"> <br />
<img src="https://captureamerica.github.io/writeups/img/ritsec_ctf_2021_chall_list2.png" alt="ritsec_ctf_2021_chall_list2.png">
<br /><br /></p>
<p>以下、Writeupです。Webと101は省略します。</p>
<p><br /><br /></p>
<h2 id="rev-snek-100-points">[Rev]: snek (100 points)</h2>
<hr>
<h3 id="challenge">Challenge</h3>
<blockquote>
<p>No step on snek</p>
</blockquote>
<p>Attachments:</p>
<ul>
<li>snek</li>
</ul>
<p><br /></p>
<h3 id="solution">Solution</h3>
<p>まずは、ファイル・タイプの確認をします。</p>
<pre>
$ file snek
snek: python 3.7 byte-compiled
</pre>
<p>ググったところ、どうやらDecompyle++ というのを使うとよさそう。</p>
<p><a href="https://github.com/zrax/pycdc">https://github.com/zrax/pycdc</a></p>
<p><br />
以下はインストールの仕方です。</p>
<pre>
$ git clone https://github.com/zrax/pycdc.git
$ cd pycdc
$ cmake .
$ make
</pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="hl"><span class="lnt">63
</span></span><span class="hl"><span class="lnt">64
</span></span><span class="hl"><span class="lnt">65
</span></span><span class="hl"><span class="lnt">66
</span></span><span class="hl"><span class="lnt">67
</span></span><span class="hl"><span class="lnt">68
</span></span><span class="hl"><span class="lnt">69
</span></span><span class="hl"><span class="lnt">70
</span></span><span class="hl"><span class="lnt">71
</span></span><span class="hl"><span class="lnt">72
</span></span><span class="hl"><span class="lnt">73
</span></span><span class="hl"><span class="lnt">74
</span></span><span class="hl"><span class="lnt">75
</span></span><span class="hl"><span class="lnt">76
</span></span><span class="hl"><span class="lnt">77
</span></span><span class="hl"><span class="lnt">78
</span></span><span class="hl"><span class="lnt">79
</span></span><span class="hl"><span class="lnt">80
</span></span><span class="hl"><span class="lnt">81
</span></span><span class="hl"><span class="lnt">82
</span></span><span class="hl"><span class="lnt">83
</span></span><span class="hl"><span class="lnt">84
</span></span><span class="hl"><span class="lnt">85
</span></span><span class="hl"><span class="lnt">86
</span></span><span class="hl"><span class="lnt">87
</span></span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-asm" data-lang="asm"><span class="nf">$</span> <span class="no">pycdas</span> <span class="no">snek</span> 
<span class="p">:</span>
<span class="err">(</span><span class="nf">snip</span><span class="p">)</span>
<span class="err">:</span>
                    <span class="err">[</span><span class="nf">Disassembly</span><span class="p">]</span>
                        <span class="err">0</span>       <span class="nf">LOAD_FAST</span>               <span class="mi">1</span><span class="p">:</span> <span class="no">password</span>
                        <span class="err">2</span>       <span class="nf">LOAD_METHOD</span>             <span class="mi">0</span><span class="p">:</span> <span class="no">encode</span>
                        <span class="err">4</span>       <span class="nf">CALL_METHOD</span>             <span class="mi">0</span>
                        <span class="err">6</span>       <span class="nf">LOAD_FAST</span>               <span class="mi">0</span><span class="p">:</span> <span class="no">self</span>
                        <span class="err">8</span>       <span class="nf">STORE_ATTR</span>              <span class="mi">1</span><span class="p">:</span> <span class="no">password</span>
                        <span class="err">10</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">1</span><span class="p">:</span> <span class="mi">97</span>
                        <span class="err">12</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">2</span><span class="p">:</span> <span class="mi">98</span>
                        <span class="err">14</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">3</span><span class="p">:</span> <span class="mi">99</span>
                        <span class="err">16</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">4</span><span class="p">:</span> <span class="mi">100</span>
                        <span class="err">18</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">5</span><span class="p">:</span> <span class="mi">101</span>
                        <span class="err">20</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">6</span><span class="p">:</span> <span class="mi">102</span>
                        <span class="err">22</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">7</span><span class="p">:</span> <span class="mi">103</span>
                        <span class="err">24</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">8</span><span class="p">:</span> <span class="mi">104</span>
                        <span class="err">26</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">9</span><span class="p">:</span> <span class="mi">105</span>
                        <span class="err">28</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">10</span><span class="p">:</span> <span class="mi">106</span>
                        <span class="err">30</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">11</span><span class="p">:</span> <span class="mi">107</span>
                        <span class="err">32</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">12</span><span class="p">:</span> <span class="mi">108</span>
                        <span class="err">34</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">13</span><span class="p">:</span> <span class="mi">109</span>
                        <span class="err">36</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">14</span><span class="p">:</span> <span class="mi">110</span>
                        <span class="err">38</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">15</span><span class="p">:</span> <span class="mi">111</span>
                        <span class="err">40</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">16</span><span class="p">:</span> <span class="mi">112</span>
                        <span class="err">42</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">17</span><span class="p">:</span> <span class="mi">113</span>
                        <span class="err">44</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">18</span><span class="p">:</span> <span class="mi">114</span>
                        <span class="err">46</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">19</span><span class="p">:</span> <span class="mi">115</span>
                        <span class="err">48</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">20</span><span class="p">:</span> <span class="mi">116</span>
                        <span class="err">50</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">21</span><span class="p">:</span> <span class="mi">117</span>
                        <span class="err">52</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">22</span><span class="p">:</span> <span class="mi">118</span>
                        <span class="err">54</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">23</span><span class="p">:</span> <span class="mi">119</span>
                        <span class="err">56</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">24</span><span class="p">:</span> <span class="mi">120</span>
                        <span class="err">58</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">25</span><span class="p">:</span> <span class="mi">121</span>
                        <span class="err">60</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">26</span><span class="p">:</span> <span class="mi">122</span>
                        <span class="err">62</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">27</span><span class="p">:</span> <span class="mi">65</span>
                        <span class="err">64</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">28</span><span class="p">:</span> <span class="mi">66</span>
                        <span class="err">66</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">29</span><span class="p">:</span> <span class="mi">67</span>
                        <span class="err">68</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">30</span><span class="p">:</span> <span class="mi">68</span>
                        <span class="err">70</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">31</span><span class="p">:</span> <span class="mi">69</span>
                        <span class="err">72</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">32</span><span class="p">:</span> <span class="mi">70</span>
                        <span class="err">74</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">33</span><span class="p">:</span> <span class="mi">71</span>
                        <span class="err">76</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">34</span><span class="p">:</span> <span class="mi">72</span>
                        <span class="err">78</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">35</span><span class="p">:</span> <span class="mi">73</span>
                        <span class="err">80</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">36</span><span class="p">:</span> <span class="mi">74</span>
                        <span class="err">82</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">37</span><span class="p">:</span> <span class="mi">75</span>
                        <span class="err">84</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">38</span><span class="p">:</span> <span class="mi">76</span>
                        <span class="err">86</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">39</span><span class="p">:</span> <span class="mi">77</span>
                        <span class="err">88</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">40</span><span class="p">:</span> <span class="mi">78</span>
                        <span class="err">90</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">41</span><span class="p">:</span> <span class="mi">79</span>
                        <span class="err">92</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">42</span><span class="p">:</span> <span class="mi">80</span>
                        <span class="err">94</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">43</span><span class="p">:</span> <span class="mi">81</span>
                        <span class="err">96</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">44</span><span class="p">:</span> <span class="mi">82</span>
                        <span class="err">98</span>      <span class="nf">LOAD_CONST</span>              <span class="mi">45</span><span class="p">:</span> <span class="mi">83</span>
                        <span class="err">100</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">46</span><span class="p">:</span> <span class="mi">84</span>
                        <span class="err">102</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">47</span><span class="p">:</span> <span class="mi">85</span>
                        <span class="err">104</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">48</span><span class="p">:</span> <span class="mi">86</span>
                        <span class="err">106</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">49</span><span class="p">:</span> <span class="mi">87</span>
                        <span class="err">108</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">50</span><span class="p">:</span> <span class="mi">88</span>
                        <span class="err">110</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">51</span><span class="p">:</span> <span class="mi">89</span>
                        <span class="err">112</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">52</span><span class="p">:</span> <span class="mi">90</span>
<span class="hl">                        <span class="err">114</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">53</span><span class="p">:</span> <span class="mi">95</span>
</span><span class="hl">                        <span class="err">116</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">44</span><span class="p">:</span> <span class="mi">82</span>
</span><span class="hl">                        <span class="err">118</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">45</span><span class="p">:</span> <span class="mi">83</span>
</span><span class="hl">                        <span class="err">120</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">54</span><span class="p">:</span> <span class="mi">123</span>
</span><span class="hl">                        <span class="err">122</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">1</span><span class="p">:</span> <span class="mi">97</span>
</span><span class="hl">                        <span class="err">124</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">12</span><span class="p">:</span> <span class="mi">108</span>
</span><span class="hl">                        <span class="err">126</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">12</span><span class="p">:</span> <span class="mi">108</span>
</span><span class="hl">                        <span class="err">128</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">53</span><span class="p">:</span> <span class="mi">95</span>
</span><span class="hl">                        <span class="err">130</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">8</span><span class="p">:</span> <span class="mi">104</span>
</span><span class="hl">                        <span class="err">132</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">9</span><span class="p">:</span> <span class="mi">105</span>
</span><span class="hl">                        <span class="err">134</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">55</span><span class="p">:</span> <span class="mi">36</span>
</span><span class="hl">                        <span class="err">136</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">55</span><span class="p">:</span> <span class="mi">36</span>
</span><span class="hl">                        <span class="err">138</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">53</span><span class="p">:</span> <span class="mi">95</span>
</span><span class="hl">                        <span class="err">140</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">1</span><span class="p">:</span> <span class="mi">97</span>
</span><span class="hl">                        <span class="err">142</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">14</span><span class="p">:</span> <span class="mi">110</span>
</span><span class="hl">                        <span class="err">144</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">4</span><span class="p">:</span> <span class="mi">100</span>
</span><span class="hl">                        <span class="err">146</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">53</span><span class="p">:</span> <span class="mi">95</span>
</span><span class="hl">                        <span class="err">148</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">14</span><span class="p">:</span> <span class="mi">110</span>
</span><span class="hl">                        <span class="err">150</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">56</span><span class="p">:</span> <span class="mi">48</span>
</span><span class="hl">                        <span class="err">152</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">53</span><span class="p">:</span> <span class="mi">95</span>
</span><span class="hl">                        <span class="err">154</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">2</span><span class="p">:</span> <span class="mi">98</span>
</span><span class="hl">                        <span class="err">156</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">9</span><span class="p">:</span> <span class="mi">105</span>
</span><span class="hl">                        <span class="err">158</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">20</span><span class="p">:</span> <span class="mi">116</span>
</span><span class="hl">                        <span class="err">160</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">57</span><span class="p">:</span> <span class="mi">51</span>
</span><span class="hl">                        <span class="err">162</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">58</span><span class="p">:</span> <span class="mi">125</span>
</span>                        <span class="err">164</span>     <span class="nf">BUILD_LIST</span>              <span class="mi">77</span>
                        <span class="err">166</span>     <span class="nf">LOAD_FAST</span>               <span class="mi">0</span><span class="p">:</span> <span class="no">self</span>
                        <span class="err">168</span>     <span class="nf">STORE_ATTR</span>              <span class="mi">2</span><span class="p">:</span> <span class="no">decrypt</span>
                        <span class="err">170</span>     <span class="nf">LOAD_CONST</span>              <span class="mi">0</span><span class="p">:</span> <span class="no">None</span>
                        <span class="err">172</span>     <span class="nf">RETURN_VALUE</span>
<span class="err">:</span>
<span class="err">(</span><span class="nf">snip</span><span class="p">)</span>
<span class="err">:</span></code></pre></td></tr></table>
</div>
</div>
<p><br /></p>
<p>上の方は数字が連番ですが、ハイライトした辺りは数字が不規則なのでそこに当たりを付けました。</p>
<p>数字を文字に変換すると、{all_hi$$_and_n0_bit3} になります。</p>
<p><br /></p>
<p>Flag: <code>RS{all_hi$$_and_n0_bit3}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="forensics-1597-100-points">[Forensics]: 1597 (100 points)</h2>
<hr>
<h3 id="challenge-1">Challenge</h3>
<blockquote>
<p>&hellip; as in <a href="https://xkcd.com/1597/">https://xkcd.com/1597/</a>
<br /><br />
<a href="http://git.ritsec.club:7000/1597.git/">http://git.ritsec.club:7000/1597.git/</a></p>
</blockquote>
<p><br /></p>
<h3 id="solution-1">Solution</h3>
<p>git cloneしてfull historyを見るだけです。</p>
<pre>
$ git clone http://git.ritsec.club:7000/1597.git/

$ cd 1597

$ git log -p --all --full-history
commit dcc402050827e92dbcf2578e24f2cba76f34229c (HEAD -> master, origin/master, origin/HEAD)
Author: knif3 <knif3@mail.rit.edu>
Date:   Fri Apr 9 05:49:00 2021 +0000

    Updated the flag

diff --git a/flag.txt b/flag.txt
index a24cab4..8b13789 100644
--- a/flag.txt
+++ b/flag.txt
@@ -1 +1 @@
-Your princess is in another castle
+

commit b123f674a07eaf5914eda8845d86b5219fc1de11 (origin/!flag)
Author: knif3 <knif3@mail.rit.edu>
Date:   Fri Apr 9 05:49:00 2021 +0000

    More flags

diff --git a/README.md b/README.md
index 0ff84f3..99ddfa8 100644
--- a/README.md
+++ b/README.md
@@ -1,3 +1,3 @@
 # 1597

-A git challenge series? Sounds fun.
+What's worse, basing a CTF challenge off of XKCD, or basing a challenge off of git?
diff --git a/flag.txt b/flag.txt
index 8b13789..013a6dd 100644
--- a/flag.txt
+++ b/flag.txt
@@ -1 +1 @@
-
+RS{git_is_just_a_tre3_with_lots_of_branches}
</pre>
<p><br /></p>
<p>Flag: <code>RS{git_is_just_a_tre3_with_lots_of_branches}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="forensics-fysa-100-points">[Forensics]: FYSA (100 points)</h2>
<hr>
<h3 id="challenge-2">Challenge</h3>
<blockquote>
<p>(記載なし)</p>
</blockquote>
<p>Attachments:</p>
<ul>
<li>BIRDTHIEF_FYSA.pdf</li>
</ul>
<p><br /></p>
<h3 id="solution-2">Solution</h3>
<p>Libre OfficeでPDFファイルを開いて4ページ目にある。黒塗りをマウスで移動。</p>
<p><br /></p>
<p>Flag: <code>RS{Make_sure_t0_read_the_briefing}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="forensics-parcel-200-points">[Forensics]: Parcel (200 points)</h2>
<hr>
<h3 id="challenge-3">Challenge</h3>
<blockquote>
<p>That&rsquo;s a lot of magick</p>
</blockquote>
<p>Attachments:</p>
<ul>
<li>Parcel</li>
</ul>
<p><br /></p>
<h3 id="solution-3">Solution</h3>
<p>まずは、ファイル・タイプの確認をします。</p>
<pre>
$ file Parcel
Parcel: gzip compressed data, from Unix, original size modulo 2^32 759456
</pre>
<p>解凍すると、メールのtcp streamが入ったテキストが出てきます。メールの添付ファイルはbase64 decodeをしたら取り出せます。</p>
<p>添付ファイルは沢山あって、数個やってみたところ、分割されたフラグの画像のようです。</p>
<img src="https://captureamerica.github.io/writeups/img/ritsec_ctf_2021_Parcel_RS.png" alt="ritsec_ctf_2021_Parcel_RS.png">
<p>スクリプトを書いた方が早いかな、と思って以下を書いて添付ファイルを全部取り出しました。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="ch">#!/usr/bin/env python3</span>
<span class="c1">#-*- coding:utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="n">lines</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;Parcel&#34;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;.png&#34;</span>
            <span class="n">wf</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">wf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
            <span class="n">wf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">+=</span> <span class="n">line</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
    <span class="k">if</span> <span class="s2">&#34;Content-Transfer-Encoding: base64&#34;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></td></tr></table>
</div>
</div><p>コードの中のflagは、base64の部分を特定するためにスイッチとして使っているものです。</p>
<p>出てきた画像の中でフラグを含んでいるものを、Libre Officeで読み込んでパズルのようにくっつけました。</p>
<img src="https://captureamerica.github.io/writeups/img/ritsec_ctf_2021_Parcel.png" alt="ritsec_ctf_2021_Parcel.png">
<p><br /></p>
<p>Flag <code>RS{Im_doing_a_v1rtual_puzzl3}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="forensics-blob-200-points">[Forensics]: Blob (200 points)</h2>
<hr>
<h3 id="challenge-4">Challenge</h3>
<blockquote>
<p>Ha. Blob. Did you get the reference?
<br /><br />
<a href="http://git.ritsec.club:7000/blob.git/">http://git.ritsec.club:7000/blob.git/</a></p>
</blockquote>
<p><br /></p>
<h3 id="solution-4">Solution</h3>
<p>packed-refsファイルの中身は以下のようになっていました。</p>
<pre>
# pack-refs with: peeled fully-peeled sorted 
a69cb6306e8b75b6762d6aa1b0279244cacf3f3b refs/remotes/origin/master
d0644363aa853a17c9672cefff587580a43cf45e refs/tags/flag
</pre>
<p><br /></p>
<p>&ldquo;git packed-refs CTF&quot;でググったら、どうやら <a href="https://overthewire.org/wargames/bandit/">OTW/bandit</a> にあるチャレンジと同じタイプのようです。</p>
<pre>
$ git show flag
RS{refs_can_b3_secret_too}
</pre>
<p><br /></p>
<p>Flag: <code>RS{refs_can_b3_secret_too}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="forensics-pleaseclickallthethings-1-begineersritsechtml-150-points">[Forensics]: PleaseClickAlltheThings 1: BegineersRITSEC.html (150 points)</h2>
<hr>
<h3 id="challenge-5">Challenge</h3>
<blockquote>
<p>Note: this challenge is the start of a series of challenges. The purpose of this CTF challenge is to bring real world phishing attachments to the challengers and attempt to find flags (previously executables or malicious domains) within the macros. This is often a process used in IR teams and becomes an extremely valuable skill. In this challenge we’ve brought to the table a malicious html file, GandCrab/Ursnif sample, and a IceID/Bokbot sample. We’ve rewritten the code to not contain malicious execution however system changes may still occur when executing, also some of the functionalities have been snipped and will likely not expose itself via dynamic analysis.
<br /><br />
- Outlook helps, with proper licensing to access necessary features. Otherwise oledump or similar would also help but isn’t necessary
<br /><br />
- CyberChef is the ideal tool to use for decoding
<br /><br />
Part 1: Start with the HTML file and let’s move our way up, open and or inspect the HTML file provide in the message file. There is only one flag in this document.
<br /><br />
This challenge is brought to you by SRA</p>
</blockquote>
<p>Attachments:</p>
<ul>
<li>Please Click all the Things.msg</li>
</ul>
<p><br /></p>
<h3 id="solution-5">Solution</h3>
<p>Macを使って調べていて、*.msgファイルを開くツールがなかったので、「foremostで添付ファイルを取り出せばいいや」と思ったのが原因で、結構ハマリました。</p>
<p>なぜなら、foremostではhtmlファイルが出てこないからです。</p>
<p>マクロを調査してフラグっぽいのも取れているのに、Invalid Flagの連発だったので、ちゃんとmsgファイルを開くことにしました。</p>
<pre>
$ sudo gem install ruby-msg
$ mapitool -i *.msg
</pre>
<p>これで、msgファイルは、emlファイルに変換されます。</p>
<p><br />
emlファイルはMacのMailアプリで開けるんですが、なんかしらアカウントの設定をしないとMailアプリが使えないというのはイケてない所ですね。。</p>
<p><br />
emlファイルを開くと、ちゃんとhtmlファイルが添付されていました。</p>
<p><br />
URLエンコードされた文字列が見つかるのでデコードしてやって、更にBase64デコードするだけです。</p>
<p><br /></p>
<p>Flag: <code>RITSEC{H3r3!t!$}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="forensics-pleaseclickallthethings-2-gandcrab_ursnif-200-points">[Forensics]: PleaseClickAlltheThings 2: GandCrab_Ursnif (200 points)</h2>
<hr>
<h3 id="challenge-6">Challenge</h3>
<blockquote>
<p>NOTE: this challenge builds upon BegineersRITSEC.html, and that challenge must be completed first.
<br /><br />
GandCrab/Ursnif are dangerous types of campaigns and malware, macros are usually the entry point, see what you can find, there are two flags in this document. Flag1/2</p>
</blockquote>
<p><br /></p>
<h3 id="solution-6">Solution</h3>
<p>これは、単にマクロの中で見つかるRITSEC{M@CROS}という文字列でした。</p>
<p><br /></p>
<p>Flag: <code>RITSEC{M@CROS}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="forensics-please-click-all-the-things-3-iceid-350-points">[Forensics]: Please Click All the Things 3: IceID (350 points)</h2>
<hr>
<h3 id="challenge-7">Challenge</h3>
<blockquote>
<p>NOTE: this challenge builds upon BegineersRITSEC.html, and that challenge must be completed first.
<br /><br />
Stepping it up to IceID/Bokbot, this challenge is like the previous challenge but requires some ability to read and understand coding in addition to some additional decoding skills, there are two flags in this document. (Flag 1/2)</p>
</blockquote>
<p><br /></p>
<h3 id="solution-7">Solution</h3>
<p>難読化されたVBAマクロを解析するチャレンジです。</p>
<p>以下がオリジナル。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Basic" data-lang="Basic"><span class="vg">Rem</span><span class="w"> </span><span class="vg">Attribute</span><span class="w"> </span><span class="vg">VBA_ModuleType</span><span class="o">=</span><span class="vg">VBAModule</span>
<span class="vg">Option</span><span class="w"> </span><span class="vg">VBASupport</span><span class="w"> </span><span class="il">1</span>
<span class="vg">Public</span><span class="w"> </span><span class="vg">Const</span><span class="w"> </span><span class="vg">aHVWt</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;p_:_\_j_v_a_q_b_j_f_\_f_l_f_g_r_z_3_2_\_z_f_u_g_n__r_k_r_&#34;</span>
<span class="vg">Public</span><span class="w"> </span><span class="vg">Const</span><span class="w"> </span><span class="vg">aqv6tf</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;EVGFRP{E0GG1ATZ@YP0Q3}&#34;</span>

<span class="vg">Public</span><span class="w"> </span><span class="vg">Const</span><span class="w"> </span><span class="vg">a7sVN</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;_&#34;</span>
<span class="vg">Public</span><span class="w"> </span><span class="vg">Const</span><span class="w"> </span><span class="vg">asXlUN</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Integer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">-954</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="il">967</span>
<span class="vg">Public</span><span class="w"> </span><span class="vg">Function</span><span class="w"> </span><span class="vg">aENoBO</span><span class="p">(</span><span class="vg">aHu95</span><span class="p">,</span><span class="w"> </span><span class="vg">avuEG8</span><span class="p">)</span>
<span class="vg">FileNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">FreeFile</span>
<span class="vg">Open</span><span class="w"> </span><span class="vg">aHu95</span><span class="w"> </span><span class="vg">For</span><span class="w"> </span><span class="vg">Output</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="err">#</span><span class="vg">FileNumber</span>
<span class="vg">Print</span><span class="w"> </span><span class="err">#</span><span class="vg">FileNumber</span><span class="p">,</span><span class="w"> </span><span class="vg">Spc</span><span class="p">(</span><span class="il">-413</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="il">456</span><span class="p">)</span>
<span class="vg">Print</span><span class="w"> </span><span class="err">#</span><span class="vg">FileNumber</span><span class="p">,</span><span class="w"> </span><span class="vg">avuEG8</span>
<span class="vg">Print</span><span class="w"> </span><span class="err">#</span><span class="vg">FileNumber</span><span class="p">,</span><span class="w"> </span><span class="vg">Spc</span><span class="p">(</span><span class="il">-413</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="il">456</span><span class="p">)</span>
<span class="vg">Close</span><span class="w"> </span><span class="err">#</span><span class="vg">FileNumber</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>
<span class="vg">Sub</span><span class="w"> </span><span class="vg">aUoaN</span><span class="p">(</span><span class="vg">adDgz</span><span class="p">,</span><span class="w"> </span><span class="vg">at09Aq</span><span class="p">)</span>
<span class="vg">FileCopy</span><span class="w"> </span><span class="vg">adDgz</span><span class="p">,</span><span class="w"> </span><span class="vg">at09Aq</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Sub</span>
<span class="vg">Function</span><span class="w"> </span><span class="vg">anPr56</span><span class="p">(</span><span class="vg">aCl8i</span><span class="p">)</span>
<span class="vg">anPr56</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">Len</span><span class="p">(</span><span class="vg">aCl8i</span><span class="p">)</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>
<span class="vg">Function</span><span class="w"> </span><span class="vg">a79yA</span><span class="p">(</span><span class="vg">aO0h5k</span><span class="p">)</span>
<span class="vg">a79yA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">aO0h5k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="il">12324</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="il">474</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>
<span class="vg">Function</span><span class="w"> </span><span class="vg">aHScDO</span><span class="p">(</span><span class="vg">aoza8</span><span class="p">)</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span>
<span class="vg">Dim</span><span class="w"> </span><span class="vg">alc6yS</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Long</span>
<span class="vg">Dim</span><span class="w"> </span><span class="vg">a9uRX</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Integer</span>
<span class="vg">Dim</span><span class="w"> </span><span class="vg">agyvb</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Integer</span>
<span class="vg">For</span><span class="w"> </span><span class="vg">alc6yS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">1</span><span class="w"> </span><span class="vg">To</span><span class="w"> </span><span class="vg">anPr56</span><span class="p">(</span><span class="vg">aoza8</span><span class="p">)</span>
<span class="vg">agyvb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">0</span>
<span class="vg">aFxdHY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">VBA</span><span class="o">.</span><span class="vg">Mid$</span><span class="p">(</span><span class="vg">aoza8</span><span class="p">,</span><span class="w"> </span><span class="vg">alc6yS</span><span class="p">,</span><span class="w"> </span><span class="il">1</span><span class="p">)</span>
<span class="vg">a9uRX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">Asc</span><span class="p">(</span><span class="vg">aFxdHY</span><span class="p">)</span>
<span class="vg">If</span><span class="w"> </span><span class="p">(</span><span class="vg">a9uRX</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">64</span><span class="w"> </span><span class="vg">And</span><span class="w"> </span><span class="vg">a9uRX</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">91</span><span class="p">)</span><span class="w"> </span><span class="vg">Or</span><span class="w"> </span><span class="p">(</span><span class="vg">a9uRX</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">96</span><span class="w"> </span><span class="vg">And</span><span class="w"> </span><span class="vg">a9uRX</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">123</span><span class="p">)</span><span class="w"> </span><span class="vg">Then</span>
<span class="vg">agyvb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">asXlUN</span>
<span class="vg">a9uRX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">a9uRX</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="vg">agyvb</span>
<span class="vg">If</span><span class="w"> </span><span class="vg">a9uRX</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">97</span><span class="w"> </span><span class="vg">And</span><span class="w"> </span><span class="vg">a9uRX</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">83</span><span class="w"> </span><span class="vg">Then</span>
<span class="vg">a9uRX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">a79yA</span><span class="p">(</span><span class="vg">a9uRX</span><span class="p">)</span>
<span class="vg">ElseIf</span><span class="w"> </span><span class="vg">a9uRX</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">65</span><span class="w"> </span><span class="vg">Then</span>
<span class="vg">a9uRX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">a79yA</span><span class="p">(</span><span class="vg">a9uRX</span><span class="p">)</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">If</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">If</span>
<span class="vg">Mid$</span><span class="p">(</span><span class="vg">aoza8</span><span class="p">,</span><span class="w"> </span><span class="vg">alc6yS</span><span class="p">,</span><span class="w"> </span><span class="il">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">VBA</span><span class="o">.</span><span class="vg">Chr$</span><span class="p">(</span><span class="vg">a9uRX</span><span class="p">)</span>
<span class="vg">Next</span>
<span class="vg">aHScDO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">aoza8</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>

<span class="vg">Rem</span><span class="w"> </span><span class="vg">Attribute</span><span class="w"> </span><span class="vg">VBA_ModuleType</span><span class="o">=</span><span class="vg">VBAModule</span>
<span class="vg">Option</span><span class="w"> </span><span class="vg">VBASupport</span><span class="w"> </span><span class="il">1</span>
<span class="vg">Sub</span><span class="w"> </span><span class="vg">main</span><span class="p">()</span>
<span class="vg">auIPjp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">aHScDO</span><span class="p">(</span><span class="vg">aTwLcg</span><span class="p">(</span><span class="vg">aHVWt</span><span class="p">))</span>
<span class="vg">aZuadn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">aHScDO</span><span class="p">(</span><span class="vg">aTwLcg</span><span class="p">(</span><span class="vg">aqv6tf</span><span class="p">))</span>
<span class="vg">a9ANR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">aHScDO</span><span class="p">(</span><span class="vg">aTwLcg</span><span class="p">(</span><span class="vg">aE0yGK</span><span class="p">))</span>
<span class="vg">aUoaN</span><span class="w"> </span><span class="vg">auIPjp</span><span class="p">,</span><span class="w"> </span><span class="vg">aZuadn</span>
<span class="vg">aENoBO</span><span class="w"> </span><span class="vg">a9ANR</span><span class="p">,</span><span class="w"> </span><span class="vg">aHScDO</span><span class="p">(</span><span class="vg">aRXKz</span><span class="p">)</span>
<span class="vg">Shell</span><span class="w"> </span><span class="vg">aZuadn</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">&#34; &#34;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="vg">a9ANR</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Sub</span>

<span class="vg">Rem</span><span class="w"> </span><span class="vg">Attribute</span><span class="w"> </span><span class="vg">VBA_ModuleType</span><span class="o">=</span><span class="vg">VBAModule</span>
<span class="vg">Option</span><span class="w"> </span><span class="vg">VBASupport</span><span class="w"> </span><span class="il">1</span>
<span class="vg">Rem</span><span class="w"> </span><span class="vg">removed</span><span class="w"> </span><span class="vg">unmatched</span><span class="w"> </span><span class="vg">Sub</span><span class="o">/</span><span class="nl">End:</span><span class="w"> </span><span class="vg">Sub</span><span class="w"> </span><span class="vg">AutoOpen</span><span class="p">()</span>
<span class="vg">Function</span><span class="w"> </span><span class="vg">aRXKz</span><span class="p">()</span>
<span class="vg">aRXKz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">frm</span><span class="o">.</span><span class="vg">txt</span><span class="o">.</span><span class="vg">Text</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>
<span class="vg">Public</span><span class="w"> </span><span class="vg">Function</span><span class="w"> </span><span class="vg">aTwLcg</span><span class="p">(</span><span class="vg">alRUYI</span><span class="p">)</span>
<span class="vg">aTwLcg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">Replace</span><span class="p">(</span><span class="vg">alRUYI</span><span class="p">,</span><span class="w"> </span><span class="vg">a7sVN</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">)</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>
<span class="vg">Sub</span><span class="w"> </span><span class="vg">AutoOpen</span><span class="p">()</span>
<span class="vg">main</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Sub</span>
<span class="vg">Public</span><span class="w"> </span><span class="vg">Sub</span><span class="w"> </span><span class="vg">a8hv3</span><span class="p">(</span><span class="vg">ai295</span><span class="p">)</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Sub</span>
<span class="vg">Rem</span><span class="w"> </span><span class="vg">removed</span><span class="w"> </span><span class="vg">unmatched</span><span class="w"> </span><span class="vg">Sub</span><span class="o">/</span><span class="nl">End:</span><span class="w"> </span><span class="vg">End</span><span class="w"> </span><span class="vg">Sub</span>
</code></pre></td></tr></table>
</div>
</div><p><br /></p>
<p>以下は、がんばって書き換えをして、見やすくしたもの。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Basic" data-lang="Basic"><span class="vg">Option</span><span class="w"> </span><span class="vg">VBASupport</span><span class="w"> </span><span class="il">1</span>
<span class="vg">Public</span><span class="w"> </span><span class="vg">Const</span><span class="w"> </span><span class="vg">str1</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;p_:_\_j_v_a_q_b_j_f_\_f_l_f_g_r_z_3_2_\_z_f_u_g_n__r_k_r_&#34;</span>
<span class="vg">Public</span><span class="w"> </span><span class="vg">Const</span><span class="w"> </span><span class="vg">str2</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;EVGFRP{E0GG1ATZ@YP0Q3}&#34;</span><span class="w">  </span><span class="c1">&#39; たぶんフラグの元</span>

<span class="vg">Public</span><span class="w"> </span><span class="vg">Function</span><span class="w"> </span><span class="vg">func3</span><span class="p">(</span><span class="vg">a</span><span class="p">,</span><span class="w"> </span><span class="vg">b</span><span class="p">)</span>
<span class="w">       </span><span class="vg">FileNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">FreeFile</span>
<span class="w">       </span><span class="vg">Open</span><span class="w"> </span><span class="vg">a</span><span class="w"> </span><span class="vg">For</span><span class="w"> </span><span class="vg">Output</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="err">#</span><span class="vg">FileNumber</span>
<span class="w">       </span><span class="vg">Print</span><span class="w"> </span><span class="err">#</span><span class="vg">FileNumber</span><span class="p">,</span><span class="w"> </span><span class="vg">Spc</span><span class="p">(</span><span class="il">43</span><span class="p">)</span>
<span class="w">       </span><span class="vg">Print</span><span class="w"> </span><span class="err">#</span><span class="vg">FileNumber</span><span class="p">,</span><span class="w"> </span><span class="vg">b</span>
<span class="w">       </span><span class="vg">Print</span><span class="w"> </span><span class="err">#</span><span class="vg">FileNumber</span><span class="p">,</span><span class="w"> </span><span class="vg">Spc</span><span class="p">(</span><span class="il">43</span><span class="p">)</span>
<span class="w">       </span><span class="vg">Close</span><span class="w"> </span><span class="err">#</span><span class="vg">FileNumber</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>

<span class="vg">Sub</span><span class="w"> </span><span class="vg">sub1</span><span class="p">(</span><span class="vg">a</span><span class="p">,</span><span class="w"> </span><span class="vg">b</span><span class="p">)</span>
<span class="w">    </span><span class="vg">FileCopy</span><span class="w"> </span><span class="vg">a</span><span class="p">,</span><span class="w"> </span><span class="vg">b</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Sub</span>

<span class="vg">Function</span><span class="w"> </span><span class="vg">anPr56</span><span class="p">(</span><span class="vg">a</span><span class="p">)</span>
<span class="w">	 </span><span class="vg">anPr56</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">Len</span><span class="p">(</span><span class="vg">a</span><span class="p">)</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>

<span class="vg">Function</span><span class="w"> </span><span class="vg">a79yA</span><span class="p">(</span><span class="vg">a</span><span class="p">)</span>
<span class="w">	 </span><span class="vg">a79yA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="il">26</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>

<span class="vg">Function</span><span class="w"> </span><span class="vg">func2</span><span class="p">(</span><span class="vg">a</span><span class="p">)</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span>
<span class="w">	 </span><span class="vg">Dim</span><span class="w"> </span><span class="vg">i</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Long</span>
<span class="w">	 </span><span class="vg">Dim</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Integer</span>
<span class="w">	 </span><span class="vg">Dim</span><span class="w"> </span><span class="vg">y</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Integer</span>

<span class="w">	 </span><span class="vg">For</span><span class="w"> </span><span class="vg">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">1</span><span class="w"> </span><span class="vg">To</span><span class="w"> </span><span class="vg">anPr56</span><span class="p">(</span><span class="vg">a</span><span class="p">)</span>
<span class="w">	 	 </span><span class="vg">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">0</span>
<span class="w">	 	 </span><span class="vg">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">VBA</span><span class="o">.</span><span class="vg">Mid$</span><span class="p">(</span><span class="vg">a</span><span class="p">,</span><span class="w"> </span><span class="vg">i</span><span class="p">,</span><span class="w"> </span><span class="il">1</span><span class="p">)</span><span class="w">   </span><span class="c1">&#39; iのポジションから1文字</span>
<span class="w">	 	 </span><span class="vg">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">Asc</span><span class="p">(</span><span class="vg">c</span><span class="p">)</span>
<span class="w">		 </span><span class="vg">If</span><span class="w"> </span><span class="p">(</span><span class="vg">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">64</span><span class="w"> </span><span class="vg">And</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">91</span><span class="p">)</span><span class="w"> </span><span class="vg">Or</span><span class="w"> </span><span class="p">(</span><span class="vg">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">96</span><span class="w"> </span><span class="vg">And</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">123</span><span class="p">)</span><span class="w"> </span><span class="vg">Then</span>
<span class="w">		     </span><span class="vg">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">13</span>
<span class="w">		     </span><span class="vg">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="vg">y</span>
<span class="w">		     </span><span class="vg">If</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">97</span><span class="w"> </span><span class="vg">And</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">83</span><span class="w"> </span><span class="vg">Then</span>
<span class="w">		     	</span><span class="vg">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">a79yA</span><span class="p">(</span><span class="vg">x</span><span class="p">)</span>
<span class="w">		     </span><span class="vg">ElseIf</span><span class="w"> </span><span class="vg">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="il">65</span><span class="w"> </span><span class="vg">Then</span>
<span class="w">		     	</span><span class="vg">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">a79yA</span><span class="p">(</span><span class="vg">x</span><span class="p">)</span>
<span class="w">		     </span><span class="vg">End</span><span class="w"> </span><span class="vg">If</span>
<span class="w">		 </span><span class="vg">End</span><span class="w"> </span><span class="vg">If</span>
<span class="w">		 </span><span class="vg">Mid$</span><span class="p">(</span><span class="vg">a</span><span class="p">,</span><span class="w"> </span><span class="vg">i</span><span class="p">,</span><span class="w"> </span><span class="il">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">VBA</span><span class="o">.</span><span class="vg">Chr$</span><span class="p">(</span><span class="vg">x</span><span class="p">)</span>
<span class="w">	</span><span class="vg">Next</span>
<span class="vg">func2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">a</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>


<span class="vg">Option</span><span class="w"> </span><span class="vg">VBASupport</span><span class="w"> </span><span class="il">1</span>
<span class="vg">Sub</span><span class="w"> </span><span class="vg">main</span><span class="p">()</span>
<span class="vg">ret1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">func2</span><span class="p">(</span><span class="vg">func1</span><span class="p">(</span><span class="vg">str1</span><span class="p">))</span>
<span class="vg">ret2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">func2</span><span class="p">(</span><span class="vg">func1</span><span class="p">(</span><span class="vg">str2</span><span class="p">))</span>
<span class="vg">ret3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">func2</span><span class="p">(</span><span class="vg">func1</span><span class="p">(</span><span class="vg">aE0yGK</span><span class="p">))</span><span class="w">  </span><span class="c1">&#39; これはどこに？ フラグとしては未使用？</span>
<span class="vg">sub1</span><span class="w"> </span><span class="vg">ret1</span><span class="p">,</span><span class="w"> </span><span class="vg">ret2</span>
<span class="vg">func3</span><span class="w"> </span><span class="vg">ret3</span><span class="p">,</span><span class="w"> </span><span class="vg">func2</span><span class="p">(</span><span class="vg">aRXKz</span><span class="p">)</span>
<span class="vg">Shell</span><span class="w"> </span><span class="vg">ret2</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">&#34; &#34;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="vg">ret3</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Sub</span>


<span class="vg">Option</span><span class="w"> </span><span class="vg">VBASupport</span><span class="w"> </span><span class="il">1</span>

<span class="vg">Function</span><span class="w"> </span><span class="vg">aRXKz</span><span class="p">()</span>
<span class="w">	 </span><span class="vg">aRXKz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">frm</span><span class="o">.</span><span class="vg">txt</span><span class="o">.</span><span class="vg">Text</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>

<span class="c1">&#39; &#34;_&#34;を取り除く。</span>
<span class="vg">Public</span><span class="w"> </span><span class="vg">Function</span><span class="w"> </span><span class="vg">func1</span><span class="p">(</span><span class="vg">a</span><span class="p">)</span>
<span class="w">       </span><span class="vg">func1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">Replace</span><span class="p">(</span><span class="vg">a</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;_&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">)</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Function</span>

<span class="vg">Sub</span><span class="w"> </span><span class="vg">AutoOpen</span><span class="p">()</span>
<span class="w">    </span><span class="vg">main</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Sub</span>

<span class="vg">Public</span><span class="w"> </span><span class="vg">Sub</span><span class="w"> </span><span class="vg">a8hv3</span><span class="p">(</span><span class="vg">ai295</span><span class="p">)</span>
<span class="vg">End</span><span class="w"> </span><span class="vg">Sub</span>
</code></pre></td></tr></table>
</div>
</div><p><br /></p>
<p>ポイントとなるのは上記の str2 と func2 で、結果的に単なるROTでした。</p>
<p><br /></p>
<p>Flag: <code>RITSEC{R0TT1NGM@LC0D3}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="forensics-inception-ctf-dream-1-100-points">[Forensics]: Inception CTF: Dream 1 (100 points)</h2>
<hr>
<h3 id="challenge-8">Challenge</h3>
<blockquote>
<p>The purpose of this CTF challenge is to identify common methods of hiding malicious files and code. In most cases adversaries will attempt to evade defenses in many cases by masquerading, hiding files, and more. There are five directories like the five levels in the movie Inception, Reality -&gt; Van Chase -&gt; The Hotel -&gt; Snow Fortress -&gt; Limbo. You will find one flag in each of the levels, that flag will also be the password to extract the next directory. Requirements: • You must have 7zip installed • Drop the InceptionCTF.7z on the Desktop as “InceptionCTF” • Use the option “Extract to &ldquo;<name of directory>\” for the CTF to function properly Missing either of the above may result in complications which may cause issues when attempting to find flags.
<br /><br />
NOTE: These challenges have a flag format of RITSEC{}
<br /><br />
Dream 1: We have to get to their subconscious first, look for a hidden text file within the directory “Reality” this flag will unlock the next directory.
<br /><br />
We would like to thank our sponsor @SRA for contributing this challenge!</p>
</blockquote>
<p>Attachments:</p>
<ul>
<li>InceptionCTFRITSEC.7z</li>
</ul>
<p><br /></p>
<h3 id="solution-8">Solution</h3>
<p>このDreamシリーズは、解いたフラグが次の7zを解凍するためのパスワードになっているので、順番に解いていく必要があります。</p>
<p>解凍していくと、Reality.7zを解凍した時点で、Subconscious.txtというのが出てきます。</p>
<p>中身：</p>
<pre>
Wait a minute, whose subconscious are we going into, exactly? {dnalmaerD}CESTIR
</pre>
<p><br /></p>
<pre>
$ echo {dnalmaerD}CESTIR | rev
RITSEC}Dreamland{
</pre>
<p><br /></p>
<p>Flag: <code>RITSEC{Dreamland}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="forensics-inception-ctf-dream-2-225-points">[Forensics]: Inception CTF: Dream 2 (225 points)</h2>
<hr>
<h3 id="challenge-9">Challenge</h3>
<blockquote>
<p>Note: This challenge builds off Inception CTF: Dream 1,
<br /><br />
Unfortunately, the subconscious isn’t enough for this mission, we have to kidnap Fischer we need to go further into the system of the mind. Use the flag found to edit the PowerShell script, entering the Flag in line three in-between the single quotes. Run the PowerShell script and wait for it to complete its actions.
<br /><br />
Thanks to SRA for providing this challenge!</p>
</blockquote>
<p><br /></p>
<h3 id="solution-9">Solution</h3>
<p>解凍していくと、Kidnap.txtというのが出てきます。</p>
<p>中身：</p>
<pre>
52 49 54 53 45 43 7b 57 61 74 65 72 55 6e 64 65 72 54 68 65 42 72 69 64 67 65 7d
</pre>
<p><br /></p>
<pre>
$ python -c 'print("".join([chr(int(x,16)) for x in "52 49 54 53 45 43 7b 57 61 74 65 72 55 6e 64 65 72 54 68 65 42 72 69 64 67 65 7d".split()]))'
RITSEC{WaterUnderTheBridge}
</pre>
<p><br /></p>
<p>Flag: <code>RITSEC{WaterUnderTheBridge}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="forensics-inception-ctf-dream-3-200-points">[Forensics]: Inception CTF: Dream 3 (200 points)</h2>
<hr>
<h3 id="challenge-10">Challenge</h3>
<blockquote>
<p>Note: This challenge builds off Inception CTF: Dream 1,
<br /><br />
Note: This challenge builds on Inception CTF: Dream 2.
<br /><br />
While the first two steps were easy it’s all hard from here on out, ThePointMan is the most crucial role of the mission he has to be presentable but without giving away our intentions. Use Alternate Dream State to find the flag before the kick.</p>
</blockquote>
<p><br /></p>
<h3 id="solution-10">Solution</h3>
<p>解凍していくと、ThePointMan.txtというのが出てきます。</p>
<p>これは、XOR bruteや、quipquip、モールス信号、ヴィジュネル暗号などを使って解けるんですが、フラグとは関係ないdecoyだった模様。</p>
<p><br /></p>
<p>別に、名無しのファイルが一個あって、その中身が以下です。</p>
<pre>
You mean, a dream within a dream? NTIgNDkgNTQgNTMgNDUgNDMgN2IgNDYgNDAgMjEgMjEgNjkgNmUgNjcgNDUgNmMgNjUgNzYgNDAgNzQgNmYgNzIgN2Q=
</pre>
<p><br /></p>
<p>base64デコードをして、数字を文字に変えるだけです。</p>
<p><br /></p>
<p>Flag: <code>RITSEC{F@!!ingElev@tor}</code></p>
<p><br /><br />
<br /><br /></p>
<h2 id="stego-inception-ctf-dream-4-200-points">[Stego]: Inception CTF: Dream 4 (200 points)</h2>
<hr>
<h3 id="challenge-11">Challenge</h3>
<blockquote>
<p>Note: This challenge builds off of InceptionCTF: Dream 3
<br /><br />
Don’t lose yourself within the dreams, it’s critical to have your totem. Take a close look at the facts of the file presented to you. Please note the flag is marked with an “RITSEC=” rather than {} due to encoding limitations.</p>
</blockquote>
<p><br /></p>
<h3 id="solution-11">Solution</h3>
<p>Dream 4からStegoカテゴリになっています。</p>
<p><br /></p>
<p>stringsをやると、URLエンコードされている部分が見つかるのでデコードするとモールス信号が出てきます。</p>
<p>モールス信号は以下でデコードしました。</p>
<p><a href="https://morsecode.world/international/translator.html">https://morsecode.world/international/translator.html</a></p>
<p>結果：</p>
<pre>
DREAMSFEELREALWHENWE'REINTHEM.IT'SONLYWHENWEWAKEUPTHATWEREALIZESOMETHINGWASACTUALLYSTRANGE.RITSEC=DIVERSION
</pre>
<p><br /></p>
<p>Flag: <code>RITSEC{DIVERSION}</code></p>
<p><br /><br />
<br /><br /></p>
<hr>
<p><br /><br />
<br /><br /></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">CaptureAmerica @ CTF フラxxグゲット</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2021-04-13
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="https://captureamerica.github.io/writeups/tags/ctf/">CTF</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="https://captureamerica.github.io/writeups/post/umdctf_2021/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">UMDCTF 2021 Writeup</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="https://captureamerica.github.io/writeups/post/picoctf_2021/">
            <span class="next-text nav-default">picoCTF 2021 Writeup</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://github.com/CaptureAmerica/" class="iconfont icon-github" title="github"></a>
  <a href="https://captureamerica.github.io/writeups/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2019 - 
    2021<span class="heart"><i class="iconfont icon-heart"></i></span><span>CaptureAmerica @ CTF フラxxグゲット</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  



<script type="text/javascript" src="https://captureamerica.github.io/writeups/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-104910699-2', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>
