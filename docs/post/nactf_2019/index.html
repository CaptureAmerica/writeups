<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>NACTF 2019 Writeup - CTF フラxxグゲット</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="CaptureAmerica @ CTF フラxxグゲット" /><meta name="description" content="日本語 &amp;nbsp; English (Google) URL: https://www.nactf.com/challenges 解いたのはこんな感じ。 Cryptoはほぼ放置。 General Skillsに出てきたCellularなんじゃも放置。 Reverse Engineerin" /><meta name="keywords" content="CTF, Writeup, captureamerica, picoCTF" />



<meta name="google-site-verification" content="PqctLWZQttGzxXVupWuIt2HWuBI8cvN1z07ETpxA2dw" />


<meta name="generator" content="Hugo 0.59.1 with theme even" />


<link rel="canonical" href="https://captureamerica.github.io/writeups/post/nactf_2019/" />
<link rel="apple-touch-icon" sizes="180x180" href="https://captureamerica.github.io/writeups/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://captureamerica.github.io/writeups/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://captureamerica.github.io/writeups/favicon-16x16.png">
<link rel="manifest" href="https://captureamerica.github.io/writeups/manifest.json">
<link rel="mask-icon" href="https://captureamerica.github.io/writeups/safari-pinned-tab.svg" color="#5bbad5">


<link href="https://captureamerica.github.io/writeups/dist/even.c2a46f00.min.css" rel="stylesheet">



<meta property="og:title" content="NACTF 2019 Writeup" />
<meta property="og:description" content="日本語 &nbsp; English (Google) URL: https://www.nactf.com/challenges 解いたのはこんな感じ。 Cryptoはほぼ放置。 General Skillsに出てきたCellularなんじゃも放置。 Reverse Engineerin" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://captureamerica.github.io/writeups/post/nactf_2019/" />
<meta property="article:published_time" content="2019-09-23T07:00:00+09:00" />
<meta property="article:modified_time" content="2019-09-23T07:00:00+09:00" />
<meta itemprop="name" content="NACTF 2019 Writeup">
<meta itemprop="description" content="日本語 &nbsp; English (Google) URL: https://www.nactf.com/challenges 解いたのはこんな感じ。 Cryptoはほぼ放置。 General Skillsに出てきたCellularなんじゃも放置。 Reverse Engineerin">


<meta itemprop="datePublished" content="2019-09-23T07:00:00&#43;09:00" />
<meta itemprop="dateModified" content="2019-09-23T07:00:00&#43;09:00" />
<meta itemprop="wordCount" content="1138">



<meta itemprop="keywords" content="CTF," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="NACTF 2019 Writeup"/>
<meta name="twitter:description" content="日本語 &nbsp; English (Google) URL: https://www.nactf.com/challenges 解いたのはこんな感じ。 Cryptoはほぼ放置。 General Skillsに出てきたCellularなんじゃも放置。 Reverse Engineerin"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="https://captureamerica.github.io/writeups/" class="logo">CTF Writeups</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="https://captureamerica.github.io/writeups/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="https://captureamerica.github.io/writeups/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="https://captureamerica.github.io/writeups/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="https://captureamerica.github.io/writeups/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="https://captureamerica.github.io/writeups/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="https://captureamerica.github.io/writeups/" class="logo">CTF Writeups</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://captureamerica.github.io/writeups/about/">About</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">NACTF 2019 Writeup</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-09-23 </span>
        <div class="post-category">
            <a href="https://captureamerica.github.io/writeups/categories/ctf/"> CTF </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#general-skills-hwang-s-hidden-handiwork-100-points">[General Skills]: Hwang's Hidden Handiwork (100 points)</a>
<ul>
<li><a href="#challenge">Challenge</a></li>
<li><a href="#solution">Solution</a></li>
</ul></li>
<li><a href="#general-skills-shcalc-200-points">[General Skills]: SHCALC (200 points)</a>
<ul>
<li><a href="#challenge-1">Challenge</a></li>
<li><a href="#solution-1">Solution</a></li>
</ul></li>
<li><a href="#crypto-loony-tunes-50-points">[Crypto]: Loony Tunes (50 points)</a>
<ul>
<li><a href="#challenge-2">Challenge</a></li>
<li><a href="#solution-2">Solution</a></li>
</ul></li>
<li><a href="#reversing-keygen-600-points">[Reversing]: Keygen (600 points)</a>
<ul>
<li><a href="#challenge-3">Challenge</a></li>
<li><a href="#unsolved">(UnSolved)</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<p><a href="https://captureamerica.github.io/writeups/post/nactf_2019/">
<img src="https://captureamerica.github.io/writeups/img/Jp.png" alt="Japanese">日本語
</a>&nbsp;
<a href="https://translate.google.com/translate?hl=en&sl=ja&tl=en&u=https%3A%2F%2Fcaptureamerica.github.io%2Fwriteups%2Fpost%2Fnactf_2019%2F">
<img src="https://captureamerica.github.io/writeups/img/En.png" alt="English">English (Google)
</a></p>

<p><br /></p>

<p>URL: <a href="https://www.nactf.com/challenges" target="_blank">https://www.nactf.com/challenges</a>
<br /><br />
解いたのはこんな感じ。
<br /><br />
<img src="https://captureamerica.github.io/writeups/img/nactf_Score1.png" alt="nactf_Score1.png"></p>

<p><img src="https://captureamerica.github.io/writeups/img/nactf_Score2.png" alt="nactf_Score2.png">
<br /><br /></p>

<p>Cryptoはほぼ放置。</p>

<p>General Skillsに出てきたCellularなんじゃも放置。</p>

<p>Reverse EngineeringのKeygenは解きたかった。でも、解けなかった。。＞＜</p>

<p>Pwnも途中でバテました。。。</p>

<p><br /><br />
いくつかWriteup残しておきます。</p>

<p><br /><br /></p>

<h2 id="general-skills-hwang-s-hidden-handiwork-100-points">[General Skills]: Hwang's Hidden Handiwork (100 points)</h2>

<hr />

<h3 id="challenge">Challenge</h3>

<blockquote>
<p>Hwang was trying to hide secret photos from his parents. His mom found a text file with a secret string and an excel chart which she thinks could help you decrypt it. Can you help uncover Hwang's Handiwork?
<br /><br />
Of course, the nobler of you may choose not to do this problem because you respect Hwang's privacy. That's ok, but you won't get the points.
<br /><br />
Hint1: Hwang used the chart to substitute each letter in the plaintext, character by character... can you reverse the process?
<br /><br />
Hint2: Hwang made the image too small to read. Can you make it bigger?</p>
</blockquote>

<p>Attachment:</p>

<ul>
<li>hwangshandiwork.txt</li>
<li>substitution.csv</li>
</ul>

<p>添付ファイルの中身は、こんなです。
<pre>
$ cat hwangshandiwork.txt
SccLJ0ddkSGy=PP=kM8JMDmPCcMCcymPedh9_r_GwDtt.::/.1TS_Ba:uU9KNpzir:VcNEVK/PPDXCImKlqK8rqtfOAvisA2MIikfjEq1ReFNC/gi_bf5fbrOSxrODf</p>

<p>$ cat substitution.csv
Plaintext,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,1,2,3,4,5,6,7,8,9,0,.,/,-,<em>,=,:
Ciphertext,T,v,m,9,M,j,=,S,a,i,w,k,e,C,P,L,X,D,J,c,8,h,f,</em>,.,t,I,B,q,R,Q,Z,U,n,K,u,l,E,-,7,6,g,N,p,/,s,Y,3,:,4,o,A,x,H,G,1,b,F,W,2,z,r,y,d,O,V,5,0
</pre></p>

<p><br /></p>

<h3 id="solution">Solution</h3>

<p>このチャレンジはなかなか面白かったです。</p>

<p>substitutionはsedを使いました。
<pre>
cat hwangshandiwork.txt | sed -e y@Tvm9Mj=SaiwkeCPLXDJc8hf<em>.tIBqRQZUnKulE-76gNp/sY3:4oAxHG1bFW2zrydOV50@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890./-</em>=:@
<a href="https://lh3.googleusercontent.com/vdx0x3krzzyWWSy4ahxBiWJGdIQR9j0W_tQL_ISoorqnAcIKCIu0Czw-ZbjTZ8eAjlwfLC4Dm6QnSPjx5w=w50-h10-rw" target="_blank">https://lh3.googleusercontent.com/vdx0x3krzzyWWSy4ahxBiWJGdIQR9j0W_tQL_ISoorqnAcIKCIu0Czw-ZbjTZ8eAjlwfLC4Dm6QnSPjx5w=w50-h10-rw</a>
</pre></p>

<p><br />
出てきたURLにアクセスすると、めっちゃちっちゃいgoogleflag.webpというファイルが取得できます。</p>

<p><img src="https://captureamerica.github.io/writeups/img/googleflag.webp.png" alt="googleflag.webp.png"></p>

<p>初めてみるファイルタイプでした。
<pre>
$ file googleflag.webp
googleflag.webp: RIFF (little-endian) data, Web/P image
</pre></p>

<p><br />
ググってみると、<br />「出てきたURLの最後の「-rw」を削るとpngやらjpgやら元の形式になりますよ」<br />とのことだったので、末尾の「-rw」を取り除いたら確かにpngとして保存できました。</p>

<pre>
$ file googleflag.png 
googleflag.png: PNG image data, 50 x 5, 8-bit/color RGB, non-interlaced
</pre>

<p><br />
ここで少し悩んで、ヒントをもう一回見直しました。</p>

<blockquote>
<p>Hint2: Hwang made the image too small to read. Can you make it bigger?</p>
</blockquote>

<p><br />
なるほど、確かにURLの末尾の方に「w50-h10」というのがあって、widthとhightっぽいのがありましたね。</p>

<p>さきほどURLをいじってファイルタイプが変わったように、ここをいじればサイズを大きくできそうです。</p>

<p>10倍「w500-h100」にしてみました。</p>

<p><a href="https://lh3.googleusercontent.com/vdx0x3krzzyWWSy4ahxBiWJGdIQR9j0W_tQL_ISoorqnAcIKCIu0Czw-ZbjTZ8eAjlwfLC4Dm6QnSPjx5w=w500-h100" target="_blank">https://lh3.googleusercontent.com/vdx0x3krzzyWWSy4ahxBiWJGdIQR9j0W_tQL_ISoorqnAcIKCIu0Czw-ZbjTZ8eAjlwfLC4Dm6QnSPjx5w=w500-h100</a></p>

<p><img src="https://captureamerica.github.io/writeups/img/googleflag.webp2.png" alt="googleflag.webp2.png"></p>

<p>へぇぇ〜</p>

<p>Flag: <code>nactf{g00gl3_15nt_s3cur3_3n0ugh}</code></p>

<p><br /><br />
<br /><br /></p>

<h2 id="general-skills-shcalc-200-points">[General Skills]: SHCALC (200 points)</h2>

<hr />

<h3 id="challenge-1">Challenge</h3>

<blockquote>
<p>John's written a handy calculator app - in bash! Too bad it's not that secure...
<br /><br />
Hint: Heard of injection?</p>
</blockquote>

<p><br /></p>

<h3 id="solution-1">Solution</h3>

<p>以下の通り。
<pre>
&gt; $(ls)
sh: 1: arithmetic expression: expecting EOF: &quot;calc.sh
flag.txt&quot;</p>

<blockquote>
<p>$(cat flag.txt)
sh: 1: arithmetic expression: expecting EOF: &quot;nactf{3v4l_1s_3v1l_dCf80yOo}&quot;
</pre></p>
</blockquote>

<p>Flag: <code>nactf{3v4l_1s_3v1l_dCf80yOo}</code></p>

<p><br /><br />
<br /><br /></p>

<h2 id="crypto-loony-tunes-50-points">[Crypto]: Loony Tunes (50 points)</h2>

<hr />

<h3 id="challenge-2">Challenge</h3>

<blockquote>
<p>Ruthie is very inhumane. She keeps her precious pigs locked up in a pen. I heard that this secret message is the password to unlocking the gate to her PIGPEN. Unfortunately, Ruthie does not want people unlocking the gate so she encoded the password. Please help decrypt this code so that we can free the pigs!
<br /><br />
P.S. &quot;_&quot; , &quot;{&quot; , and &quot;}&quot; are not part of the cipher and should not be changed
<br /><br />
P.P.S the flag is all lowercase</p>
</blockquote>

<p>Attachment:</p>

<ul>
<li>pig.jpg</li>
</ul>

<p><img src="https://captureamerica.github.io/writeups/img/pig.jpg" alt="pig.jpg"></p>

<p><br /></p>

<h3 id="solution-2">Solution</h3>

<p>問題文の中の「PIGPEN」が大文字になっていたのでググってみると、Pigpen Cipherっていうのが見つかりました。</p>

<p><a href="https://en.wikipedia.org/wiki/Pigpen_cipher" target="_blank">https://en.wikipedia.org/wiki/Pigpen_cipher</a></p>

<p>あとは、それにしたがって一文字ずつ解読するだけです。</p>

<p>Flag: <code>nactf{th_th_th_thats_all_folks}</code></p>

<p><br /><br />
<br /><br /></p>

<h2 id="reversing-keygen-600-points">[Reversing]: Keygen (600 points)</h2>

<hr />

<h3 id="challenge-3">Challenge</h3>

<blockquote>
<p>Can you figure out what the key to this program is?
<br /><br />
Hint: Don't know where to start? Fire up a debugger, or look for cross-references to data you know something about.</p>
</blockquote>

<p>Attachment:</p>

<ul>
<li>keygen-1 (ELF 32bit)</li>
</ul>

<p><br /></p>

<h3 id="unsolved">(UnSolved)</h3>

<p>これは見る限りangrで解く問題だと思うんですけど、どうにも答えが得られなかったです。</p>

<p>Keyサイズは8文字。</p>

<p>Keyとして利用できる文字は0~9、a~z、A~Zなんですが、全部対象にすると結構なパターンになるし、Keyは1パターンじゃないだろうから文字を絞って（例えば数字だけとかにして）constraintsに設定してやればできる気がしたんですけどね。</p>

<p>後日、復習しておきます。</p>

<p><br /><br />
<br /><br /></p>

<hr />

<p><br /><br />
<br /><br /></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">CaptureAmerica @ CTF フラxxグゲット</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2019-09-23
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="https://captureamerica.github.io/writeups/tags/ctf/">CTF</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="https://captureamerica.github.io/writeups/post/picoctf_2019_binary/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">picoCTF 2019 Writeup (Binary Exploitation)</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="https://captureamerica.github.io/writeups/post/sect_ctf_2019/">
            <span class="next-text nav-default">SEC-T CTF 2019 Writeup</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://github.com/CaptureAmerica/" class="iconfont icon-github" title="github"></a>
  <a href="https://captureamerica.github.io/writeups/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2019 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">CaptureAmerica @ CTF フラxxグゲット</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  
<script type="text/javascript" src="https://captureamerica.github.io/writeups/dist/even.26188efa.min.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-104910699-2', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>
